---
title: "SixSeven Results "
author: "Elika"
output: html_document
---

#Talk, you're on camera
#06 and 07 aud vid comparison

```{r read in data, comment=F, message=F, hide = T, warning = F}
source("sixseven_data_aggregation.R")
```
#Results 
Based on the coding scheme above, we derived count (n=12) and proportional (n=10) measures from the annotations in each file. See table XX. We then aggregated the data at the recording level, generating derived count and proportion values for each child, for each recording-type, for each month. For all recording type and month comparisons, we look at whether the data varied significantly (by two-tailed, paired Wilcoxon-Test), and correlated significantly (by Kendall Rank Correlation) across the given groups. We applied Holm’s p-value adjustment for multiple comparisons (Holm, 1979). 

##Derived Counts, Month 6 vs. 7
We first analyzed the 12 derived count measures in month six versus seven, by recording-type. Across children, all 12 derived count audio measures correlated significantly month-to-month (Kendall’s tau ranged from .25 to .51; all adjusted-p<.05), and did not significantly differ by month (all adjusted-p>.05). All video measures too correlated significantly month-to-month (Kendall’s tau ranged from .29-.60; all adjusted-p<.05), except number of reading tokens (adjusted-p>.05). For video too no derived count measures varied significantly from six to seven months (all adjusted-p>.05). Thus, within recording type, the count-based metrics of the object words infants heard were statistically equivalent in month six and seven, and correlated significantly within children month-to-month (except 1 of the 24 correlations). This suggests that parents are likely behaving relatively naturally during recordings, or are adjusting their behavior as a function of our observations to an extremely consistent degree. 

##Derived Counts, Audio vs. Video-recordings
We next assessed how quantity of input scaled between our hour-long video recordings and daylong audio recordings. While video recordings were all around an hour (Mean, SD, Range, XX), the length of audio recordings varied (M=14.4(XX sd), R=10.5-16 hrs). The modal recording length was 16 hours, the maximum capacity of the LENA devices. However, children varied in their naptime schedule, and indeed from audio alone it can be hard to know with certainty whether the child was asleep. As described in the Methods section, we demarcated all long stretches of silence and thus have an upper-limit on their wakeful (i.e. non-silent) hours (Mean, SD, Range.). This is in line with established norms for 6–8-month-olds in the US (Mandel et al, 2010), which report the average amount of sleep is 3 hours during the day, and 10 hour during the night. Thus, given a 24-hour day, 16 hours of recording beginning when the child wakes up should capture roughly 11 daytime hours, in line with our silence demarcations. 

To examine how the video data ‘scale’ to day-length data, we divided the audio-recording measures by the number of wakeful hours in each audio-file, providing an hourly average that could be compared to the video-recording data. We then divide the quantity from the (hour-long) video-recording by the hourly audio-average to compute a ‘Video Boost’ for each metric. For example, infants heard XX noun-tokens on average in their audio recordings, and XX in their video tokens. This renders an average of XX tokens per audio hour (after dividing each audio-recording by its number of wakeful hours), and thus a XX/XX = XX Video Boost. See Table XX.

Another way to compute the difference between the daylong and hourlong recordings is to simply divide the audio count by the video count. Doing this results in a range of 2.5-4  across our metrics, rather than the tenfold increase one would expect if video recordings captured an average hour of the day.
Still need to do stats for this section after normalizing by length

##Derived Proportions, Month 6 vs. 7.
Unlike the count-based measures, the 10 proportional measures from each recording-type are readily comparable without further computation. Descriptively, within recording type, the differences month-to-month were small. Indeed, as with the derived count measures, there were no significant differences between month six and seven within audio or video recordings (all adjusted-p>.05). The pattern of correlations differed somewhat from the derived counts: for the audio recordings, 7/10 proportional measures correlated from month 6 to month 7 (for these seven measures: Kendall’s tau range: .31-.46, adjusted-p<.05; for object co-presence, questions, and short-phrases adjusted-p>.05). For video data, only proportion of input from mom and from dad correlated from month 6 to month 7 (Kendall’s tau = .45 and .63, respectively; adjusted-p<.05). Thus, overall, at the group level, the proportional metrics were very stable month-to-month within recording type, but the correlations between the proportional measures across children at month six and seven were variable, especially for video-recordings.

##Derived Proportions, Audio vs. Video-recordings
Across recording types, proportional measures differed more substantively; see figure XX. Within the speaker-based metrics, the video recordings featured mothers more and fathers less than the audio recordings (by ~15% and 5% respectively, XX). This likely reflects the demographics of our dataset: nearly all families had full-time working fathers, but mothers’ work schedules varied, and video recordings took place on weekdays during the typical work-day hours. Videos featured more object co-presence (~10%) than audio-recordings, likely reflecting the less far-ranging activities families engaged in while video equipment was present. Regarding quantity, videos also had a higher type to token ratio (i.e. more lexical diversity), even using the MATTR  (Fergatiotis et al, 2011), a point we return to later.

Across utterance-types, at a gross level, the distributions of nouns in audio and video-recordings were similar, with declaratives making up most of the noun input, followed by questions, with the remaining input spread relatively evenly across imperatives, reading, singing, and short phrases. However, audio recordings featured relatively more declaratives and fewer questions than videos (XX, and XX%, respectively). 

Statistically, at six months, 4/10 proportional measures differed significantly between audio and video recordings (proportion of object presence, declaratives, questions, and type-token ratio, all adj-p<.05), though the average estimated difference was only 2.4%. Only the proportion of imperatives correlated significantly across recording-types (Kendall’s tau = .31, adj-p<.05). At seven months, the same four proportional measures differed significantly across recording types (avg. estimated difference, 2.5%), in addition to the proportion of input from mothers and from fathers (all adj-p<.05). However, three of the four variables that differed significantly at seven months also correlated significantly (proportion of noun input from mom, dad, and in declaratives), along with the proportion of nouns heard in reading in the input (all adj-p<.05, Kendall’s tau range: .30-.33).  We return to appropriate interpretation for this mixed pattern of correlations and differences in the discussion.

##Noun Frequency and Prevalence 
We next characterized whether audio and video recordings captured the same nouns and the same relative frequencies by examining word frequency across each month, recording type, and infant. The distribution of nouns in our recordings was zipfian: of the 5,811 unique object words heard across months and recording types, only 3,322 were heard more than once.
  
 
Looking at the top 100 audio and video nouns (collapsing month), we find that their frequencies across recording-types correlate significantly (Spearman’s rho=.35, p<.0001), though many these top 100 nouns occurred *only* in audio or video recordings; see figure XX. When we compute instead the frequency of the top 100 words by recording-type for each month, while all correlations are significant, we find stronger correlations month-to-month than across recording types within month (month 6 audio vs. video: rho = .23, month 6 audio vs. video: rho = .22, month 6 vs. 7 audio: rho = .67, month 6 vs. 7 video: rho = .36, all adj-p<.05; see figure XX). 
   

Finally, in a descriptive analysis of the top ten words by month and recording-type, we again find greater consistency across months than recording modalities (see table XX). Indeed, top words within recording-type were largely overlapping, while only two words overlapped on all four lists (book and baby). Furthermore, if instead we characterize how words were spread across infants and months, we find that the top audio words were far more common across families than the top video words (see figure XX). 


```{r top-words, warning=F, message= F}
#collapsing month
top100av <- sixseven_basiclevel_home_data%>%
  group_by(audio_video, object)%>%
  tally()%>%
  top_n(100,n)

top100av_spread <- top100av %>% 
  spread(audio_video, n,fill = 0) %>% 
  group_by(object) %>% 
  mutate(aud_vid_sum = sum(audio,video, na.rm=T)) %>% 
  arrange(-aud_vid_sum)

cor.test(top100av_spread$audio, top100av_spread$video, method = "spearman")# sig cor, but ~1/2 are 0s
top100av_spread %>% 
  mutate(zeroA_V= ifelse(audio==0|video==0,T,F)) %>% 
  group_by(zeroA_V) %>% 
  tally()

top100av67 <- sixseven_basiclevel_home_data%>%
   group_by(audio_video, month,object)%>%
  tally() %>% 
#   group_by(object)%>%
#   summarise(n = n(),
#             nfams = n_distinct(subj)) %>% 
#   #filter(nfams>11) %>% #only including words that 25% the families heard in that recording-type and month
#   #dplyr::select(-nfams) %>% #but then removing this var for further spreading below
#   #ungroup() %>% 
#   #group_by(audio_video, month) %>%
   top_n(100,n) %>%
#   arrange(-nfams, n) %>% 
#   filter(!(nfams==1 & n==1)& nfams>1) %>% 
  arrange(audio_video, month, -n)


  
#uncollapsing month
# top100av <- sixseven_basiclevel_home_data%>%
#   group_by(audio_video, object, month)%>%
#   tally()%>%
#   top_n(100,n)
# View(top100av)
# 
# top100av_spread <- top100av %>% 
#   spread(audio_video, n,fill = 0) %>% 
#   group_by(object) %>% 
#   mutate(aud_vid_sum = sum(audio,video, na.rm=T)) %>% 
#   arrange(-aud_vid_sum)

top100av67_avspread <- top100av67 %>% 
  spread(audio_video, n, fill = 0) %>% 
  group_by(object, month) %>% 
  mutate(aud_vid_sum = sum(audio,video, na.rm=T)) %>% 
  arrange(-aud_vid_sum)

top100av67_avspread %>% 
  mutate(zeroA_V= ifelse(audio==0|video==0,T,F)) %>% 
  group_by(zeroA_V) %>% 
  tally()

top100audio_monthspread <- top100av67_avspread %>% 
  dplyr::select(-video, -aud_vid_sum) %>% 
  spread(month, audio, fill = 0) %>% 
  rename(six = `06`,
         seven = `07`) %>% 
  filter(!(six==0 & seven==0)) %>% 
  mutate(audio_video="audio")

top100video_monthspread <- top100av67_avspread %>% 
  dplyr::select(-audio, -aud_vid_sum) %>% 
  spread(month, video, fill = 0) %>% 
  rename(six = `06`,
         seven = `07`) %>% 
  filter(!(six==0 & seven==0)) %>% 
  mutate(audio_video="video")
top100_monthspread <- bind_rows(top100audio_monthspread, top100video_monthspread)

#could holmes adjust these as needed

cor_sixavtop <- cor.test(subset(top100av67_avspread, month=="06")$audio, subset(top100av67_avspread, month=="06")$video, method = "spearman") %>% tidy()#.23
cor_sevavtop <-cor.test(subset(top100av67_avspread, month=="07")$audio, subset(top100av67_avspread, month=="07")$video, method = "spearman") %>% tidy()#.22
cor_sixsevenAtop <-cor.test(top100audio_monthspread$six, top100audio_monthspread$seven, method = "spearman") %>% tidy()#.67
cor_sixsevenVtop <- cor.test(top100video_monthspread$six, top100video_monthspread$seven, method = "spearman") %>% tidy()#.36
cor_AVtop<-cor.test(top100av_spread$audio, top100av_spread$video, method = "spearman") %>% tidy()

#cor top100 by month a vs. v
#plots in paper draft
ggplot(top100av67_avspread, aes(audio, video))+facet_wrap(~month)+geom_point(shape=1)+ggtitle("Freq. of Top 100 Words, Audio vs. Video Counts")
ggplot(top100_monthspread, aes(six, seven))+facet_wrap(~audio_video, scales = "free")+geom_point(shape =1) + ggtitle("Freq. of Top 100 Words, 6 vs 7 mo. Counts")


```
## Word Tallies
```{r word tallies}
#unique object words across months and recordings types
overall_tally <- sixseven_basiclevel_home_data %>% 
  group_by(basic_level) %>%
  tally() %>% 
  arrange(-n)
#ggplot(overall_tally %>% filter(n>1), aes(n))+geom_histogram()+scale_y_log10()+scale_x_log10()

#that happen more than in once
sixseven_basiclevel_home_data %>% 
  group_by(object) %>% 
  tally() %>% 
  filter(n>1)

tally_month_av<- sixseven_basiclevel_home_data %>% 
  group_by(object,audio_video, month) %>%
  tally() %>% 
  arrange(-n)
#plot in paper draft
ggplot(tally_month_av, aes(n, fill = month))+geom_histogram()+
  facet_grid(month~audio_video,scales = "free")+
  scale_x_log10()+scale_y_log10()+ggtitle("Rank by Frequency, A, V, 6, 7")


#unique within audio
audiounique <- sixseven_basiclevel_home_data %>% 
  filter(audio_video=="audio") %>% 
  group_by(object) %>%
  tally() %>% 
  arrange(-n)


#that happen more than in once within audio
audunique_morethanonce <- sixseven_basiclevel_home_data %>% 
  filter(audio_video=="audio") %>% 
  group_by(object) %>% 
  tally() %>% 
  filter(n>1)

#unique within video
videounique <- sixseven_basiclevel_home_data %>% 
  filter(audio_video=="video") %>% 
  group_by(object) %>%
  tally()

#that happen more than in once within video
vidunique_morethanonce <-sixseven_basiclevel_home_data %>% 
  filter(audio_video=="video") %>% 
  group_by(object) %>% 
  tally() %>% 
  filter(n>1)

#audio that is not in video
#video that is not in audio
#1868 words occured in audio more than once but video never
aud_morethanonce_nevervid <- audiounique %>% 
  filter(!object%in% videounique$object & n>1) %>% 
  mutate(cap = ifelse(tolower(object)!=object, T, F)) %>% 
  nrow()

#of which 270 were proper nouns
aud_morethanonce_nevervid_proper <- audiounique %>% 
  filter(!object%in% videounique$object & n>1) %>% 
  mutate(cap = ifelse(tolower(object)!=object, T, F)) %>% 
  group_by(cap) %>% 
  dplyr::select(-n) %>% 
  tally()

#201 words occured in video more than once but audio never
vid_morethanonce_neveraud <- videounique %>% 
  filter(!object%in% audiounique$object & n>1) %>% 
  mutate(cap = ifelse(tolower(object)!=object, T, F)) %>% 
  nrow()

#of which 76 were proper nouns
vid_morethanonce_neveraud_proper <- videounique %>% 
  filter(!object%in% audiounique$object & n>1) %>% 
  mutate(cap = ifelse(tolower(object)!=object, T, F)) %>% 
  group_by(cap) %>% 
  dplyr::select(-n) %>% 
  tally()
```

```{r tallying graphs}
#top100 graph, log space
#plot in draft
ggplot(top100av_spread, aes(audio+.1, video+.1, color = (audio==0 |video==0)))+
  geom_label_repel(aes(label=object),label.size = .10,
  label.padding = unit(0.1, "lines"),
  segment.color = "grey90")+
  theme_bw(base_size=18)+
  guides(colour=F)+scale_x_log10()+scale_y_log10()+
  ggtitle("Top 100 words, log space (added .1 before takng log)")


overall_month_top10 <-sixseven_basiclevel_home_data%>%
  group_by(audio_video, month, object)%>%
  summarise(n = n(),
            nfams = n_distinct(subj)) %>% 
  top_n(10,n) %>% 
  arrange(audio_video, month, -n)

#overall_month_top10 %>% View()
#top 10 by av and by month
#plot in draft
ggplot(overall_month_top10, aes(n, nfams, label = object, colour = audio_video, fill = object))+
  facet_wrap(~month)+
  geom_label_repel(segment.color = "grey50")+
  theme_bw(base_size=18)+
  scale_colour_manual(values = c("white","black"))+
  ggtitle("Top 10 words by recording type and month")+
  guides(fill=F)
  


# #ggplot(top100av67_avspread, aes(audio+.1, video+.1, color = (audio==0 |video==0)))+
# ggplot(top100av67_avspread, aes(audio, video, color = (audio==0 |video==0)))+
#   geom_label_repel(aes(label=object),label.size = .10,
#   label.padding = unit(0.1, "lines"), size = 3,
#   point.padding = unit(1.6, 'lines'),
#   segment.color = '#cccccc',
#   segment.alpha =.5,
#   force=.5, fill = "white")+
# #  nudge_x = ifelse(top100av67_avspread$video == 0, 10, 
# #                   ifelse(top100av67_avspread$audio ==0, -10, 0)),
# #  nudge_y = ifelse(top100av67_avspread$video == 0, -40, 
# #                   ifelse(top100av67_avspread$audio ==0, 20, 0)))+
#       #arrow = arrow(length = unit(0.02, 'npc')))+
#   theme_bw(base_size=14)+
#   guides(color=F)+facet_wrap(~month, nrow=1)+
#   geom_point()#+scale_x_log10()+scale_y_log10()

```

#stats
```{r wilcoxon & correlations}
#
monthav_ttr <- sixseven_basiclevel_home_data_agg %>% 
  group_by(month, audio_video)%>%
  summarise(mean(type_token_ratio))

#sixseven_spreadAV %>% 
monthav_numsp <- sixseven_basiclevel_home_data_agg %>% 
  group_by(month, audio_video)%>%
  summarise(median(numspeakers, na.rm=T),
            mean(numspeakers, na.rm=T),
            sd(numspeakers, na.rm=T))

monthav_FAT <- sixseven_basiclevel_home_data_agg %>% 
  group_by(month, audio_video)%>%
  summarise(median(FAT, na.rm=T),
            mean(FAT, na.rm=T),
            sd(FAT, na.rm=T))
# none of the audio count vars 6 vs 7 are different
wa1 <- wilcox.test(sixseven_aud$six_numtokens, sixseven_aud$sev_numtokens, conf.int=T, paired = T)
wa2 <- wilcox.test(sixseven_aud$six_numtypes, sixseven_aud$sev_numtypes, conf.int=T, paired = T)
wa3 <- wilcox.test(sixseven_aud$six_numspeakers, sixseven_aud$sev_numspeakers, conf.int=T, paired = T)
wa4 <- wilcox.test(sixseven_aud$six_MOT, sixseven_aud$sev_MOT, conf.int=T, paired = T)
wa5 <- wilcox.test(sixseven_aud$six_FAT, sixseven_aud$sev_FAT, conf.int=T, paired = T)
wa6 <- wilcox.test(sixseven_aud$six_d, sixseven_aud$sev_d, conf.int=T, paired = T)
wa7 <- wilcox.test(sixseven_aud$six_q, sixseven_aud$sev_q, conf.int=T, paired = T)
wa8 <- wilcox.test(sixseven_aud$six_r, sixseven_aud$sev_r, conf.int=T, paired = T)
wa9 <- wilcox.test(sixseven_aud$six_s, sixseven_aud$sev_s, conf.int=T, paired = T)
wa10 <- wilcox.test(sixseven_aud$six_i, sixseven_aud$sev_i, conf.int=T, paired = T)
wa11 <- wilcox.test(sixseven_aud$six_n, sixseven_aud$sev_n, conf.int=T, paired = T)
wa12 <- wilcox.test(sixseven_aud$six_y_op, sixseven_aud$sev_y_op, conf.int=T, paired = T)


wa_ps <- cbind(wa1$p.value,wa2$p.value,wa3$p.value, wa4$p.value, wa5$p.value, wa6$p.value, wa7$p.value, wa8$p.value, wa9$p.value, wa10$p.value, wa11$p.value, wa12$p.value)
round(p.adjust(wa_ps, method = "holm"),3)
round(wa_ps, 3)
table(wa_ps<.05)
table(p.adjust(wa_ps, method = "holm")<.05) #12 F


#most video 6vs7 aren't different
wv1 <- wilcox.test(sixseven_vid$six_numtokens,sixseven_vid$sev_numtokens, conf.int=T, paired = T)
wv2 <- wilcox.test(sixseven_vid$six_numtypes,sixseven_vid$sev_numtypes, conf.int=T, paired = T)
wv3 <- wilcox.test(sixseven_vid$six_numspeakers,sixseven_vid$sev_numspeakers, conf.int=T, paired = T)
wv4 <- wilcox.test(sixseven_vid$six_MOT,sixseven_vid$sev_MOT, conf.int=T, paired = T)
wv5 <- wilcox.test(sixseven_vid$six_d,sixseven_vid$sev_d, conf.int=T, paired = T)
wv6 <- wilcox.test(sixseven_vid$six_r,sixseven_vid$sev_r, conf.int=T, paired = T)
wv7 <- wilcox.test(sixseven_vid$six_i,sixseven_vid$sev_i, conf.int=T, paired = T)
wv8 <- wilcox.test(sixseven_vid$six_y_op,sixseven_vid$sev_y_op, conf.int=T, paired = T)
wv9 <- wilcox.test(sixseven_vid$six_q,sixseven_vid$sev_q, conf.int=T, paired = T)
wv10 <- wilcox.test(sixseven_vid$six_n,sixseven_vid$sev_n, conf.int=T, paired = T)
wv11 <- wilcox.test(sixseven_vid$six_s,sixseven_vid$sev_s, conf.int=T, paired = T)
wv12 <- wilcox.test(sixseven_vid$six_FAT,sixseven_vid$sev_FAT, conf.int=T, paired = T)

wv_ps <- cbind(wv1$p.value,wv2$p.value,wv3$p.value, wv4$p.value, wv5$p.value, wv6$p.value, wv7$p.value, wv8$p.value, wv9$p.value, wv10$p.value, wv11$p.value, wv12$p.value)
round(p.adjust(wv_ps, method = "holm"),3)
round(wv_ps, 3)
table(wv_ps<.05)
table(p.adjust(wv_ps, method = "holm")<.05) # 12 F
```

```{r cor tests 6 vs 7}
# do six vs. seven audio count vars correlate
ca1 <- wilcox.test(sixseven_aud$six_numtokens, sixseven_aud$sev_numtokens, conf.int=T, method = "kendall")
ca2 <- wilcox.test(sixseven_aud$six_numtypes, sixseven_aud$sev_numtypes, conf.int=T, method = "kendall")
ca3 <- wilcox.test(sixseven_aud$six_numspeakers, sixseven_aud$sev_numspeakers, conf.int=T, method = "kendall")
ca4 <- wilcox.test(sixseven_aud$six_MOT, sixseven_aud$sev_MOT, conf.int=T, method = "kendall")
ca5 <- wilcox.test(sixseven_aud$six_FAT, sixseven_aud$sev_FAT, conf.int=T, method = "kendall")
ca6 <- wilcox.test(sixseven_aud$six_d, sixseven_aud$sev_d, conf.int=T, method = "kendall")
ca7 <- wilcox.test(sixseven_aud$six_q, sixseven_aud$sev_q, conf.int=T, method = "kendall")
ca8 <- wilcox.test(sixseven_aud$six_r, sixseven_aud$sev_r, conf.int=T, method = "kendall")
ca9 <- wilcox.test(sixseven_aud$six_s, sixseven_aud$sev_s, conf.int=T, method = "kendall")
ca10 <- wilcox.test(sixseven_aud$six_i, sixseven_aud$sev_i, conf.int=T, method = "kendall")
ca11 <- wilcox.test(sixseven_aud$six_n, sixseven_aud$sev_n, conf.int=T, method = "kendall")
ca12 <- wilcox.test(sixseven_aud$six_y_op, sixseven_aud$sev_y_op, conf.int=T, method = "kendall")

ca_ps <- cbind(ca1$p.value,ca2$p.value,ca3$p.value, ca4$p.value, ca5$p.value, ca6$p.value, ca7$p.value, ca8$p.value, ca9$p.value, ca10$p.value, ca11$p.value, ca12$p.value)
round(p.adjust(ca_ps, method = "holm"),3)
round(ca_ps, 3)
table(ca_ps<.05)
table(p.adjust(ca_ps, method = "holm")<.05) #12 T

ca_taus <- cbind(ca1$estimate,ca2$estimate,ca3$estimate, ca4$estimate, ca5$estimate, ca6$estimate, ca7$estimate, ca8$estimate, ca9$estimate, ca10$estimate, ca11$estimate, ca12$estimate)
range(ca_taus)

# do six vs. seven video count vars correlate

cv1 <- wilcox.test(sixseven_vid$six_numtokens,sixseven_vid$sev_numtokens, conf.int=T, method = "kendall")
cv2 <- wilcox.test(sixseven_vid$six_numtypes,sixseven_vid$sev_numtypes, conf.int=T, method = "kendall")
cv3 <- wilcox.test(sixseven_vid$six_numspeakers,sixseven_vid$sev_numspeakers, conf.int=T, method = "kendall")
cv4 <- wilcox.test(sixseven_vid$six_MOT,sixseven_vid$sev_MOT, conf.int=T, method = "kendall")
cv5 <- wilcox.test(sixseven_vid$six_d,sixseven_vid$sev_d, conf.int=T, method = "kendall")
cv6 <- wilcox.test(sixseven_vid$six_r,sixseven_vid$sev_r, conf.int=T, method = "kendall")
cv7 <- wilcox.test(sixseven_vid$six_i,sixseven_vid$sev_i, conf.int=T, method = "kendall")
cv8 <- wilcox.test(sixseven_vid$six_y_op,sixseven_vid$sev_y_op, conf.int=T, method = "kendall")
cv9 <- wilcox.test(sixseven_vid$six_q,sixseven_vid$sev_q, conf.int=T, method = "kendall")
cv10 <- wilcox.test(sixseven_vid$six_n,sixseven_vid$sev_n, conf.int=T, method = "kendall")
cv11 <- wilcox.test(sixseven_vid$six_s,sixseven_vid$sev_s, conf.int=T, method = "kendall")
cv12 <- wilcox.test(sixseven_vid$six_FAT,sixseven_vid$sev_FAT, conf.int=T, method = "kendall")

cv_ps <- cbind(cv1$p.value,cv2$p.value,cv3$p.value, cv4$p.value, cv5$p.value, cv6$p.value, cv7$p.value, cv8$p.value, cv9$p.value, cv10$p.value, cv11$p.value, cv12$p.value)
round(p.adjust(cv_ps, method = "holm"),3)
round(cv_ps,3)
table(cv_ps<.05)
table(p.adjust(cv_ps, method = "holm")<.05) # 11 T, 1 F
cv6
#taking out cv6 bc it's not sig, reading count
cv_taus <- cbind(cv1$estimate,cv2$estimate,cv3$estimate, cv4$estimate, cv5$estimate, cv7$estimate, cv8$estimate, cv9$estimate, cv10$estimate, cv11$estimate, cv12$estimate)
range(cv_taus)

#rough estimate for what we'll get when we properly divide by video hour
sixseven_basiclevel_home_data_agg%>%
  group_by(audio_video) %>% 
  summarise(meantokens = mean(numtokens, na.rm=T),
    meantokens_hour = mean(as.numeric(as.character(ifelse(audio_video=="audio", numtokens/11, numtokens))), na.rm=T))

```

```{r 6vs 7 prop measures wilcox}
# none of the audio props 6 vs 7 are different
pwa1 <- wilcox.test(sixseven_aud$six_prop_op,sixseven_aud$sev_prop_op, conf.int=T, paired = T)
pwa2 <- wilcox.test(sixseven_aud$six_prop_mom,sixseven_aud$sev_prop_mom, conf.int=T, paired = T)
pwa3 <- wilcox.test(sixseven_aud$six_prop_dad,sixseven_aud$sev_prop_dad, conf.int=T, paired = T)
pwa4 <- wilcox.test(sixseven_aud$six_propd,sixseven_aud$sev_propd, conf.int=T, paired = T)
pwa5 <- wilcox.test(sixseven_aud$six_propi,sixseven_aud$sev_propi, conf.int=T, paired = T)
pwa6 <- wilcox.test(sixseven_aud$six_propr,sixseven_aud$sev_propr, conf.int=T, paired = T)
pwa7 <- wilcox.test(sixseven_aud$six_propq,sixseven_aud$sev_propq, conf.int=T, paired = T)
pwa8 <- wilcox.test(sixseven_aud$six_props,sixseven_aud$sev_props, conf.int=T, paired = T)
pwa9 <- wilcox.test(sixseven_aud$six_propn,sixseven_aud$sev_propn, conf.int=T, paired = T)
pwa10 <- wilcox.test(sixseven_aud$six_type_token_ratio,sixseven_aud$sev_type_token_ratio, conf.int=T, paired = T)

pwa_ps <- cbind(pwa1$p.value,pwa2$p.value,pwa3$p.value, pwa4$p.value, pwa5$p.value, pwa6$p.value, pwa7$p.value, pwa8$p.value, pwa9$p.value, pwa10$p.value)
round(p.adjust(pwa_ps, method = "holm"),3)
round(pwa_ps, 3)
table(pwa_ps<.05)
table(p.adjust(pwa_ps, method = "holm")<.05) # 10 F

# none of the video props 6vs7 are different
pwv1 <- wilcox.test(sixseven_vid$six_prop_op,sixseven_vid$sev_prop_op, conf.int=T, paired = T)
pwv2 <- wilcox.test(sixseven_vid$six_prop_mom,sixseven_vid$sev_prop_mom, conf.int=T, paired = T)
pwv3 <- wilcox.test(sixseven_vid$six_prop_dad,sixseven_vid$sev_prop_dad, conf.int=T, paired = T)
pwv4 <- wilcox.test(sixseven_vid$six_propd,sixseven_vid$sev_propd, conf.int=T, paired = T)
pwv5 <- wilcox.test(sixseven_vid$six_propi,sixseven_vid$sev_propi, conf.int=T, paired = T)
pwv6 <- wilcox.test(sixseven_vid$six_propr,sixseven_vid$sev_propr, conf.int=T, paired = T)
pwv7 <- wilcox.test(sixseven_vid$six_propq,sixseven_vid$sev_propq, conf.int=T, paired = T)
pwv8 <- wilcox.test(sixseven_vid$six_props,sixseven_vid$sev_props, conf.int=T, paired = T)
pwv9 <- wilcox.test(sixseven_vid$six_propn,sixseven_vid$sev_propn, conf.int=T, paired = T)
pwv10 <- wilcox.test(sixseven_vid$six_type_token_ratio,sixseven_vid$sev_type_token_ratio, conf.int=T, paired = T)
pwv_ps <- cbind(pwv1$p.value,pwv2$p.value,pwv3$p.value, pwv4$p.value, pwv5$p.value, pwv6$p.value, pwv7$p.value, pwv8$p.value, pwv9$p.value, pwv10$p.value)
round(p.adjust(pwv_ps, method = "holm"),3)
round(pwv_ps, 3)
table(pwv_ps<.05)
table(p.adjust(pwv_ps, method = "holm")<.05) # 10 F
```

```{r cor tests 6 vs 7 prop measures}
#7/10 prop vars correlate six vs. seven within audio
pca1 <- cor.test(sixseven_aud$six_prop_op,sixseven_aud$sev_prop_op, conf.int=T, method = "kendall")
pca2 <- cor.test(sixseven_aud$six_prop_mom,sixseven_aud$sev_prop_mom, conf.int=T, method = "kendall")
pca3 <- cor.test(sixseven_aud$six_prop_dad,sixseven_aud$sev_prop_dad, conf.int=T, method = "kendall")
pca4 <- cor.test(sixseven_aud$six_propd,sixseven_aud$sev_propd, conf.int=T, method = "kendall")
pca5 <- cor.test(sixseven_aud$six_propi,sixseven_aud$sev_propi, conf.int=T, method = "kendall")
pca6 <- cor.test(sixseven_aud$six_propr,sixseven_aud$sev_propr, conf.int=T, method = "kendall")
pca7 <- cor.test(sixseven_aud$six_propq,sixseven_aud$sev_propq, conf.int=T, method = "kendall")
pca8 <- cor.test(sixseven_aud$six_props,sixseven_aud$sev_props, conf.int=T, method = "kendall")
pca9 <- cor.test(sixseven_aud$six_propn,sixseven_aud$sev_propn, conf.int=T, method = "kendall")
pca10 <- cor.test(sixseven_aud$six_type_token_ratio,sixseven_aud$sev_type_token_ratio, conf.int=T, method = "kendall")
pca_ps <- cbind(pca1$p.value,pca2$p.value,pca3$p.value, pca4$p.value, pca5$p.value, pca6$p.value, pca7$p.value, pca8$p.value, pca9$p.value, pca10$p.value)
round(p.adjust(pca_ps, method = "holm"),3)# 2,3,4,5,6,8,10: all but propop, propq, and propn
round(pca_ps, 3)
table(pca_ps<.05)
table(p.adjust(pca_ps, method = "holm")<.05) # 7 true, 3 false

#removing 1 7 and 9 bc ns
pca_taus <- cbind(pca2$estimate,pca3$estimate, pca4$estimate, pca5$estimate, pca6$estimate, pca8$estimate, pca10$estimate)
range(pca_taus)


#2/10 prop vars correlate six vs. seven within video
pcv1 <- cor.test(sixseven_vid$six_prop_op,sixseven_vid$sev_prop_op, conf.int=T, method = "kendall")
pcv2 <- cor.test(sixseven_vid$six_prop_mom,sixseven_vid$sev_prop_mom, conf.int=T, method = "kendall")
pcv3 <- cor.test(sixseven_vid$six_prop_dad,sixseven_vid$sev_prop_dad, conf.int=T, method = "kendall")
pcv4 <- cor.test(sixseven_vid$six_propd,sixseven_vid$sev_propd, conf.int=T, method = "kendall")
pcv5 <- cor.test(sixseven_vid$six_propi,sixseven_vid$sev_propi, conf.int=T, method = "kendall")
pcv6 <- cor.test(sixseven_vid$six_propr,sixseven_vid$sev_propr, conf.int=T, method = "kendall")
pcv7 <- cor.test(sixseven_vid$six_propq,sixseven_vid$sev_propq, conf.int=T, method = "kendall")
pcv8 <- cor.test(sixseven_vid$six_props,sixseven_vid$sev_props, conf.int=T, method = "kendall")
pcv9 <- cor.test(sixseven_vid$six_propn,sixseven_vid$sev_propn, conf.int=T, method = "kendall")
pcv10 <- cor.test(sixseven_vid$six_type_token_ratio,sixseven_vid$sev_type_token_ratio, conf.int=T, method = "kendall")

pcv_ps <- cbind(pcv1$p.value,pcv2$p.value,pcv3$p.value, pcv4$p.value, pcv5$p.value, pcv6$p.value, pcv7$p.value, pcv8$p.value, pcv9$p.value, pcv10$p.value)
round(p.adjust(pcv_ps, method = "holm"),3)#prop_mom, prop_dad, 
round(pcv_ps,3)
table(pcv_ps<.05)
table(p.adjust(pcv_ps, method = "holm")<.05) #2 true, 8 false

pcv2 
pcv3 


```



```{r wilcox tests AV prop}
#most six props aren't different
propwsix1 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month=="06"& subj!="17"), prop_op~audio_video, conf.int=T, paired = T)
propwsix2 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month=="06"& subj!="17"), prop_mom~audio_video, conf.int=T, paired = T)
propwsix3 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month=="06"& subj!="17"), prop_dad~audio_video, conf.int=T, paired = T)
propwsix4 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month=="06"& subj!="17"), propd~audio_video, conf.int=T, paired = T)
propwsix5 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month=="06"& subj!="17"), propi~audio_video, conf.int=T, paired = T)
propwsix6 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month=="06"& subj!="17"), propr~audio_video, conf.int=T, paired = T)
propwsix7 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month=="06"& subj!="17"), propq~audio_video, conf.int=T, paired = T)
propwsix8 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month=="06"& subj!="17"), props~audio_video, conf.int=T, paired = T)
propwsix9 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month=="06"& subj!="17"), propn~audio_video, conf.int=T, paired = T)
propwsix10 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month=="06"& subj!="17"), type_token_ratio~audio_video, conf.int=T, paired = T)

propwsix_ps <- cbind(propwsix1$p.value,propwsix2$p.value,propwsix3$p.value, propwsix4$p.value, propwsix5$p.value, propwsix6$p.value, propwsix7$p.value, propwsix8$p.value, propwsix9$p.value, propwsix10$p.value)
round(p.adjust(propwsix_ps, method = "holm"),3) #1, 4,7, 10: prop_op, propd, propq, and ttr
round(propwsix_ps, 3)
table(propwsix_ps<.05)
table(p.adjust(propwsix_ps, method = "holm")<.05) # 3 T 7 False
propwsix_estdiff <- cbind(propwsix1$estimate,propwsix2$estimate,propwsix3$estimate, propwsix4$estimate, propwsix5$estimate, propwsix6$estimate, propwsix7$estimate, propwsix8$estimate, propwsix9$estimate, propwsix10$estimate)
range((propwsix_estdiff))
median(propwsix_estdiff)
mean(propwsix_estdiff)


#most seven props aren't different
propwseven1 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month=="07"), prop_op~audio_video, conf.int=T, paired = T)
propwseven2 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month=="07"), prop_mom~audio_video, conf.int=T, paired = T)
propwseven3 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month=="07"), prop_dad~audio_video, conf.int=T, paired = T)
propwseven4 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month=="07"), propd~audio_video, conf.int=T, paired = T)
propwseven5 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month=="07"), propi~audio_video, conf.int=T, paired = T)
propwseven6 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month=="07"), propr~audio_video, conf.int=T, paired = T)
propwseven7 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month=="07"), propq~audio_video, conf.int=T, paired = T)
propwseven8 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month=="07"), props~audio_video, conf.int=T, paired = T)
propwseven9 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month=="07"), propn~audio_video, conf.int=T, paired = T)
propwseven10 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month=="07"), type_token_ratio~audio_video, conf.int=T, paired = T)

propwseven_ps <- cbind(propwseven1$p.value,propwseven2$p.value,propwseven3$p.value, propwseven4$p.value, propwseven5$p.value, propwseven6$p.value, propwseven7$p.value, propwseven8$p.value, propwseven9$p.value, propwseven10$p.value)
round(p.adjust(propwseven_ps, method = "holm"),3) #1, 2,3,4,7,10: prop_op, prop_mom, prop_dad, propd, propq, and ttr
round(propwseven_ps, 3)
table(propwseven_ps<.05)
table(p.adjust(propwseven_ps, method = "holm")<.05)

propwseven_estdiff <- cbind(propwseven1$estimate,propwseven2$estimate,propwseven3$estimate, propwseven4$estimate, propwseven5$estimate, propwseven6$estimate, propwseven7$estimate, propwseven8$estimate, propwseven9$estimate, propwseven10$estimate)
range((propwseven_estdiff))
median(propwseven_estdiff)
mean(propwseven_estdiff)

```

```{r prop AV cor tests}
#only propi is correlated at 6 months, audio to video
propcsix1 <- cor.test(data=subset(sixseven_spreadAV, month=="06"& subj!="17"), ~v_prop_op+a_prop_op,conf.int=T, method = "kendall")
propcsix2 <- cor.test(data=subset(sixseven_spreadAV, month=="06"& subj!="17"), ~v_prop_mom+a_prop_mom,conf.int=T, method = "kendall")
propcsix3 <- cor.test(data=subset(sixseven_spreadAV, month=="06"& subj!="17"), ~v_prop_dad+a_prop_dad,conf.int=T, method = "kendall")
propcsix4 <- cor.test(data=subset(sixseven_spreadAV, month=="06"& subj!="17"), ~v_propd+a_propd,conf.int=T, method = "kendall")
propcsix5 <- cor.test(data=subset(sixseven_spreadAV, month=="06"& subj!="17"), ~v_propi+a_propi,conf.int=T, method = "kendall")
propcsix6 <- cor.test(data=subset(sixseven_spreadAV, month=="06"& subj!="17"), ~v_propr+a_propr,conf.int=T, method = "kendall")
propcsix7 <- cor.test(data=subset(sixseven_spreadAV, month=="06"& subj!="17"), ~v_propq+a_propq,conf.int=T, method = "kendall")
propcsix8 <- cor.test(data=subset(sixseven_spreadAV, month=="06"& subj!="17"), ~v_props+a_props,conf.int=T, method = "kendall")
propcsix9 <- cor.test(data=subset(sixseven_spreadAV, month=="06"& subj!="17"), ~v_propn+a_propn,conf.int=T, method = "kendall")
propcsix10 <- cor.test(data=subset(sixseven_spreadAV, month=="06"& subj!="17"), ~v_type_token_ratio+a_type_token_ratio,conf.int=T, method = "kendall")

propcsix_ps <- cbind(propcsix1$p.value,propcsix2$p.value,propcsix3$p.value, propcsix4$p.value, propcsix5$p.value, propcsix6$p.value, propcsix7$p.value, propcsix8$p.value, propcsix9$p.value, propcsix10$p.value)
round(p.adjust(propcsix_ps, method = "holm"),3) #only propi
round(propcsix_ps, 3)
table(propcsix_ps<.05)
table(p.adjust(propcsix_ps, method = "holm")<.05)
propcsix5

#4 seven props a vs. v are correlated
propcseven1 <- cor.test(data=subset(sixseven_spreadAV, month=="07"), ~v_prop_op+a_prop_op,conf.int=T, method = "kendall")
propcseven2 <- cor.test(data=subset(sixseven_spreadAV, month=="07"), ~v_prop_mom+a_prop_mom,conf.int=T, method = "kendall")
propcseven3 <- cor.test(data=subset(sixseven_spreadAV, month=="07"), ~v_prop_dad+a_prop_dad,conf.int=T, method = "kendall")
propcseven4 <- cor.test(data=subset(sixseven_spreadAV, month=="07"), ~v_propd+a_propd,conf.int=T, method = "kendall")
propcseven5 <- cor.test(data=subset(sixseven_spreadAV, month=="07"), ~v_propi+a_propi,conf.int=T, method = "kendall")
propcseven6 <- cor.test(data=subset(sixseven_spreadAV, month=="07"), ~v_propr+a_propr,conf.int=T, method = "kendall")
propcseven7 <- cor.test(data=subset(sixseven_spreadAV, month=="07"), ~v_propq+a_propq,conf.int=T, method = "kendall")
propcseven8 <- cor.test(data=subset(sixseven_spreadAV, month=="07"), ~v_props+a_props,conf.int=T, method = "kendall")
propcseven9 <- cor.test(data=subset(sixseven_spreadAV, month=="07"), ~v_propn+a_propn,conf.int=T, method = "kendall")
propcseven10 <- cor.test(data=subset(sixseven_spreadAV, month=="07"), ~v_type_token_ratio+a_type_token_ratio,conf.int=T, method = "kendall")

propcseven_ps <- cbind(propcseven1$p.value,propcseven2$p.value,propcseven3$p.value, propcseven4$p.value, propcseven5$p.value, propcseven6$p.value, propcseven7$p.value, propcseven8$p.value, propcseven9$p.value, propcseven10$p.value)
round(p.adjust(propcseven_ps, method = "holm"),3) #2,3,4,6: propmom, propdad, propd, propr
round(propcseven_ps, 3)
table(propcseven_ps<.05)
table(p.adjust(propcseven_ps, method = "holm")<.05)

propcseven_taus <- cbind(propcseven2$estimate,propcseven3$estimate, propcseven4$estimate, propcseven6$estimate) 
range(propcseven_taus)



```

```{r}


# propvals_med <- sixseven_basiclevel_home_data_agg %>% 
#   dplyr::select(month, audio_video, prop_op, prop_mom, prop_dad, propd, propi, propn, propq, propr, props, type_token_ratio) %>% 
#   group_by(month, audio_video) %>% 
#   #summarise_if(is.numeric, funs(min, max, mean, median))
#   summarise_if(is.numeric, funs(median)) %>% 
#   gather(prop_meas, medianval, prop_op:type_token_ratio)
# 
# propvals_mean <- sixseven_basiclevel_home_data_agg %>% 
#   dplyr::select(month, audio_video, prop_op, prop_mom, prop_dad, propd, propi, propn, propq, propr, props, type_token_ratio) %>% 
#   group_by(month, audio_video) %>% 
#   #summarise_if(is.numeric, funs(min, max, mean, median))
#   summarise_if(is.numeric, funs(mean)) %>% 
#   gather(prop_meas, meanval, prop_op:type_token_ratio)

propvals_long <- sixseven_basiclevel_home_data_agg %>% 
  dplyr::select(month, audio_video, subj, prop_op, prop_mom, prop_dad, propd, propq, propn, props, propr, propi, type_token_ratio) %>% 
  group_by(month, audio_video, subj) %>% 
  gather(prop_meas, propval, prop_op:type_token_ratio) %>% 
  mutate(prop_meas=factor(prop_meas),
         prop_meas = fct_relevel(prop_meas,
                                  c("prop_op", "prop_mom", "prop_dad", "propd", "propq", "propn", "props", "propr", "propi","type_token_ratio")),
meas_type = fct_collapse(prop_meas,
                                  speaker = c("prop_mom","prop_dad"),
                                  utt = c("propd","propq","propn","props","propr","propi"),
                                  quant = "type_token_ratio",
                                  op = "prop_op"))

countvals_long <- sixseven_basiclevel_home_data_agg %>% 
  dplyr::select(month, audio_video, subj, y_op, MOT, FAT, d, q, n, s, r, i, numtypes, numtokens, numspeakers) %>% 
  group_by(month, audio_video, subj) %>% 
  gather(count_meas, countval, y_op:numspeakers) %>% 
  mutate(count_meas=factor(count_meas),
         count_meas = fct_relevel(count_meas,
                                  c("y_op", "MOT", "FAT", "d", "q", "n", "s", "r", "i", "numtypes", "numtokens", "numspeakers")),
    meas_type = fct_collapse(count_meas,
                                  speaker = c("MOT","FAT"),
                                  speaker_num = c("numspeakers"),
                                  utt = c("d","q","n","s","r","i"),
                                  quant = c("numtypes","numtokens"),
                                  op = "y_op"))


#plots in draft
ggplot(propvals_long, aes(fill = prop_meas, linetype =audio_video, month, propval))+
  stat_summary(fun.y=mean, geom="bar", position = "dodge", aes(linetype=audio_video),color = "black")+
  stat_summary(fun.data=mean_cl_boot, geom="pointrange", position=position_dodge(width=.9), 
               aes(group = interaction(prop_meas,month,audio_video)))+
  facet_wrap(~meas_type, nrow = 2, scales = "free_y")

ggplot(countvals_long, aes(fill = count_meas, linetype =audio_video, month, countval))+
  stat_summary(fun.y=mean, geom="bar", position = "dodge", aes(linetype=audio_video), color = "black")+
  stat_summary(fun.data=mean_cl_boot, geom="pointrange", position=position_dodge(width=.9), 
               aes(group = interaction(count_meas,month,audio_video)))+
  facet_wrap(meas_type~audio_video, scales = "free_y", ncol=2)

summary(sixseven_basiclevel_home_data_agg$numtypes)
summary(sixseven_basiclevel_home_data_agg$numtokens)


```
#MATTR
#tables
#figures of freq by month/word
#by hour





