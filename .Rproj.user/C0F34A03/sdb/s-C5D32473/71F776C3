{
    "collab_server" : "",
    "contents" : "---\ntitle: \"SixSeven\"\nauthor: \"Elika\"\ndate: \"May 15, 2017\"\noutput: html_document\n---\n\n#talk, you're on camera\n#06 and 07 aud vid comparison\n```{r}\nlibrary(tidyverse)\nlibrary(feather)\nlibrary(ggrepel)\nlibrary(broom)\nlibrary(forcats)\nlibrary(koRpus)\n```\n\n```{r read in data}\n\n#ggplot(clantime, aes(total_min,SubjectNumber))+geom_point()+theme_bw(base_size=8)\nsixseven_basiclevel_home_data <- read_feather(\"data/all_basiclevel_feather7-19-17\")%>%\n  filter(month%in% c(\"06\",\"07\"))%>%\n  droplevels()\n  \nsixseven_basiclevel_home_data_agg <- read_feather(\"data/all_basiclevel_home_data_agg_feather7-19-17\")%>%\n  filter(month%in% c(\"06\",\"07\"))%>%\n  droplevels() %>% \n  dplyr::select(subj:num_exp_types, d, q, n, s, r,i, TOY:tech, propd, propq, propn, props, propr, propi, everything())\nsixupdated <- sixseven_basiclevel_home_data_agg%>%\n  filter(month==\"06\")\nsummary(sixseven_basiclevel_home_data_agg$subj, maxsum = 50)\n\n#vid lengths\nvidtime <- read_csv(\"data/vidlengths_subject_files_1-30-16.csv\") %>% \n  separate(file, into = c(\"SubjectNumber\", \"extra\"), sep = 5, remove = T, extra = drop) %>% \n  dplyr::select(-extra) %>% \n  rename(total = `length(s)`) %>% \n  mutate(total_min = round(total/60,1)) %>% \n  arrange(-total_min) %>% \n  filter(SubjectNumber %in%sixseven_basiclevel_home_data$SubjectNumber) %>% \n  mutate(audio_video=\"video\") %>% \n  dplyr::select(-total)\n\n#ggplot(vidtime, aes(total_min, SubjectNumber))+geom_point()+theme_bw(base_size=8)\n\n#aud lengths\naudtime <- read_csv(\"data/ACLEW_list_of_corpora - recording_level.csv\") %>%\n  rename(SubjectNumber = \"lab_internal_subject_id\",\n         total_min = \"length_of_recording\") %>% \n  filter(SubjectNumber %in% sixseven_basiclevel_home_data$SubjectNumber) %>% \n  dplyr::select(SubjectNumber, total_min) %>% \n  mutate(audio_video =\"audio\",\n         total_min = as.numeric(as.character(total_min)))\n# clantime <- read_csv(\"data/clantime_06_07.csv\") %>% \n#   separate(file, into = c(\"SubjectNumber\", \"extra\"), sep = 5, remove = T, extra = drop) %>% \n#   dplyr::select(-extra) %>% \n#   mutate(total_min = total/1000/60,\n#          total_hr = total/1000/60/60,\n#          awake = total-silence-skip,\n#          awake_min = awake/1000/60,\n#          silence_min = silence/1000/60,\n#          skip_min = skip/1000/60,\n#          total_less_sil_min = (total-silence)/1000/60)%>% \n#   arrange(-skip_min)\nclantime %>% \n  filter(SubjectNumber%in%sixseven_basiclevel_home_data_agg$SubjectNumber) %>%\n  rename(total_min_clan = total_min) %>% \n  left_join(sixseven_basiclevel_home_data_agg) %>% \n  dplyr::select(SubjectNumber, total_min_clan, total_min, audio_video, month) %>% \n  filter(audio_video==\"audio\" & month==\"06\") %>% View()\n\nsixseven_basiclevel_home_data_agg <- audtime %>% bind_rows(vidtime) %>% \n  left_join(sixseven_basiclevel_home_data_agg) %>% \n  mutate(SubjectNumber = factor(SubjectNumber),\n         audio_video = factor(audio_video))\n\n#we want a spread version of the data too\naudio_ag <- sixseven_basiclevel_home_data_agg%>%\n  filter(audio_video==\"audio\" & SubjectNumber!=\"17_06\")%>%\n  dplyr::select(-noun_chi_onset, -posttalk)%>%\n  setNames(paste0('a_', names(.)))%>%\n  rename(subj=a_subj,\n         month = a_month,\n         SubjectNumber= a_SubjectNumber)\n\nsixseven_spreadAV <- sixseven_basiclevel_home_data_agg%>%\n  filter(audio_video==\"video\")%>%\n  dplyr::select(-noun_chi_onset, -posttalk)%>%\n  setNames(paste0('v_', names(.)))%>%\n  rename(subj=v_subj,\n         month = v_month,\n         SubjectNumber= v_SubjectNumber)%>%\n  bind_cols(audio_ag)\n\n#month spread\nsix_spreadmonth <- sixseven_basiclevel_home_data_agg%>%\n  filter(month==\"06\")%>%\n  dplyr::select(-noun_chi_onset, -posttalk, -SubjectNumber)%>%\n  setNames(paste0('six_', names(.)))%>%\n  rename(subj=six_subj,\n         month = six_month,\n         audio_video = six_audio_video)\n\nsixseven_spreadmonth <- sixseven_basiclevel_home_data_agg%>%\n  filter(month==\"07\" & !(audio_video==\"video\" & subj==\"17\"))%>%\n  dplyr::select(-noun_chi_onset, -posttalk, -SubjectNumber)%>%\n  setNames(paste0('sev_', names(.)))%>%\n  rename(subj=sev_subj,\n         month = sev_month,\n         audio_video = sev_audio_video)%>%\n  bind_cols(six_spreadmonth)\n\n```\n\n#sheer #s of speakers, types, tokens, utterance types\n\n```{r counts}\n#numspeakers\nggplot(sixseven_basiclevel_home_data_agg, \n       aes(month, numspeakers, color=audio_video))+\n  geom_violin()+\n  geom_point(position = position_jitterdodge(dodge.width=.9, jitter.width = .1, jitter.height = 0), shape = 21)+\n  stat_summary(fun.data=mean_cl_boot, position = position_dodge(width=.9), aes(group=audio_video), color=\"black\")\n\n#numtypes\nggplot(sixseven_basiclevel_home_data_agg, \n       aes(month, numtokens, color=audio_video))+\n  geom_violin()+\n  geom_point(position = position_jitterdodge(dodge.width=.9, jitter.width = .1, jitter.height = 0), shape = 21)+\n  stat_summary(fun.data=mean_cl_boot, position = position_dodge(width=.9), aes(group=audio_video), color=\"black\")\n\n#numtokens\nggplot(sixseven_basiclevel_home_data_agg, \n       aes(month, numtypes, color=audio_video))+\n  geom_violin()+\n  geom_point(position = position_jitterdodge(dodge.width=.9, jitter.width = .1, jitter.height = 0), shape = 21)+\n  stat_summary(fun.data=mean_cl_boot, position = position_dodge(width=.9), aes(group=audio_video), color=\"black\")\n\n#FAT huge diff, maybe 10fold?\nggplot(sixseven_basiclevel_home_data_agg, \n       aes(month, FAT, color=audio_video))+\n  geom_violin()+\n  geom_point(position = position_jitterdodge(dodge.width=.9, jitter.width = .1, jitter.height = 0), shape = 21)+\n  stat_summary(fun.data=mean_cl_boot, position = position_dodge(width=.9), aes(group=audio_video), color=\"black\")\n#MOT: big diff but not 10fold\nggplot(sixseven_basiclevel_home_data_agg, \n       aes(month, MOT, color=audio_video))+\n  geom_violin()+\n  geom_point(position = position_jitterdodge(dodge.width=.9, jitter.width = .1, jitter.height = 0), shape = 21)+\n  stat_summary(fun.data=mean_cl_boot, position = position_dodge(width=.9), aes(group=audio_video), color=\"black\")\n\n# d big diff but not 10fold\nggplot(sixseven_basiclevel_home_data_agg, \n       aes(month, i, color=audio_video))+\n  geom_violin()+\n  geom_point(position = position_jitterdodge(dodge.width=.9, jitter.width = .1, jitter.height = 0), shape = 21)+\n  stat_summary(fun.data=mean_cl_boot, position = position_dodge(width=.9), aes(group=audio_video), color=\"black\")\n\n#q \nggplot(sixseven_basiclevel_home_data_agg, \n        aes(month, q, color=audio_video))+\n   geom_violin()+\n   geom_point(position = position_jitterdodge(dodge.width=.9, jitter.width = .1, jitter.height = 0), shape = 21)+\n   stat_summary(fun.data=mean_cl_boot, position = position_dodge(width=.9), aes(group=audio_video), color=\"black\")\n#s\nggplot(sixseven_basiclevel_home_data_agg, \n        aes(month, s, color=audio_video))+\n   geom_violin()+\n   geom_point(position = position_jitterdodge(dodge.width=.9, jitter.width = .1, jitter.height = 0), shape = 21)+\n   stat_summary(fun.data=mean_cl_boot, position = position_dodge(width=.9), aes(group=audio_video), color=\"black\")\n#r\nggplot(sixseven_basiclevel_home_data_agg, \n        aes(month, r, color=audio_video))+\n   geom_violin()+\n   geom_point(position = position_jitterdodge(dodge.width=.9, jitter.width = .1, jitter.height = 0), shape = 21)+\n   stat_summary(fun.data=mean_cl_boot, position = position_dodge(width=.9), aes(group=audio_video), color=\"black\")\n#n\nggplot(sixseven_basiclevel_home_data_agg, \n        aes(month, n, color=audio_video))+\n   geom_violin()+\n   geom_point(position = position_jitterdodge(dodge.width=.9, jitter.width = .1, jitter.height = 0), shape = 21)+\n   stat_summary(fun.data=mean_cl_boot, position = position_dodge(width=.9), aes(group=audio_video), color=\"black\")\n#i\nggplot(sixseven_basiclevel_home_data_agg, \n        aes(month, i, color=audio_video))+\n   geom_violin()+\n   geom_point(position = position_jitterdodge(dodge.width=.9, jitter.width = .1, jitter.height = 0), shape = 21)+\n   stat_summary(fun.data=mean_cl_boot, position = position_dodge(width=.9), aes(group=audio_video), color=\"black\")\n#TOY\nggplot(sixseven_basiclevel_home_data_agg, \n        aes(month, TOY, label=subj, color= audio_video))+\n   geom_violin()+\n   geom_point(position = position_jitterdodge(dodge.width=.9, jitter.width = .1, jitter.height = 0), shape = 21)+\n   stat_summary(fun.data=mean_cl_boot, position = position_dodge(width=.9), aes(group=audio_video), color=\"black\")\n\n#TOY without 0s & with labels\nggplot(sixseven_basiclevel_home_data_agg %>%filter(TOY>0), \n        aes(month, TOY, label=subj, color= audio_video))+\n   geom_violin()+\n   #geom_point(position = position_jitterdodge(dodge.width=.9, jitter.width = .1, jitter.height = 0), shape = 21)+\n   stat_summary(fun.data=mean_cl_boot, position = position_dodge(width=.9), aes(group=audio_video), color=\"black\")+\n     geom_label_repel(\n  label.size = .10,\n  label.padding = unit(0.1, \"lines\"))+scale_y_log10()\n\n```\n\n#various props\n\n```{r props}\n#prop_op: higher for video by roughly 10%\nggplot(sixseven_basiclevel_home_data_agg, \n       aes(month, prop_op, color=audio_video))+\n  geom_violin()+\n  geom_point(position = position_jitterdodge(dodge.width=.9, jitter.width = .1, jitter.height = 0), shape = 21)+\n  stat_summary(fun.data=mean_cl_boot, position = position_dodge(width=.9), aes(group=audio_video), color=\"black\")\n\n#prop_mom: higher for video by roughly 15%\nggplot(sixseven_basiclevel_home_data_agg, \n       aes(month, prop_mom, color=audio_video))+\n  geom_violin()+\n  geom_point(position = position_jitterdodge(dodge.width=.9, jitter.width = .1, jitter.height = 0), shape = 21)+\n  stat_summary(fun.data=mean_cl_boot, position = position_dodge(width=.9), aes(group=audio_video), color=\"black\")\n\n#prop_dad: comparably low in both;~15%\nggplot(sixseven_basiclevel_home_data_agg, \n       aes(month, prop_dad, color=audio_video))+\n  geom_violin()+\n  geom_point(position = position_jitterdodge(dodge.width=.9, jitter.width = .1, jitter.height = 0), shape = 21)+\n  stat_summary(fun.data=mean_cl_boot, position = position_dodge(width=.9), aes(group=audio_video), color=\"black\")\n\n#prop_parent: same\nggplot(sixseven_basiclevel_home_data_agg, \n       aes(month, prop_parent, color=audio_video))+\n  geom_violin()+\n  geom_point(position = position_jitterdodge(dodge.width=.9, jitter.width = .1, jitter.height = 0), shape = 21)+\n  stat_summary(fun.data=mean_cl_boot, position = position_dodge(width=.9), aes(group=audio_video), color=\"black\")\n\n#prop_tech: same. identical.\nggplot(sixseven_basiclevel_home_data_agg, \n       aes(month, prop_tech, color=audio_video))+\n  geom_violin()+\n  geom_point(position = position_jitterdodge(dodge.width=.9, jitter.width = .1, jitter.height = 0), shape = 21)+\n  stat_summary(fun.data=mean_cl_boot, position = position_dodge(width=.9), aes(group=audio_video), color=\"black\")\n\n#propd: 10% more in audio (looks sig dif)\nggplot(sixseven_basiclevel_home_data_agg, \n       aes(month, propd, color=audio_video))+\n  geom_violin()+\n  geom_point(position = position_jitterdodge(dodge.width=.9, jitter.width = .1, jitter.height = 0), shape = 21)+\n  stat_summary(fun.data=mean_cl_boot, position = position_dodge(width=.9), aes(group=audio_video), color=\"black\")\n\n#propi: same\nggplot(sixseven_basiclevel_home_data_agg, \n       aes(month, propi, color=audio_video))+\n  geom_violin()+\n  geom_point(position = position_jitterdodge(dodge.width=.9, jitter.width = .1, jitter.height = 0), shape = 21)+\n  stat_summary(fun.data=mean_cl_boot, position = position_dodge(width=.9), aes(group=audio_video), color=\"black\")\n\n#propn: same\nggplot(sixseven_basiclevel_home_data_agg, \n       aes(month, propn, color=audio_video))+\n  geom_violin()+\n  geom_point(position = position_jitterdodge(dodge.width=.9, jitter.width = .1, jitter.height = 0), shape = 21)+\n  stat_summary(fun.data=mean_cl_boot, position = position_dodge(width=.9), aes(group=audio_video), color=\"black\")\n\n#propq: more in vid\nggplot(sixseven_basiclevel_home_data_agg, \n       aes(month, propq, color=audio_video))+\n  geom_violin()+\n  geom_point(position = position_jitterdodge(dodge.width=.9, jitter.width = .1, jitter.height = 0), shape = 21)+\n  stat_summary(fun.data=mean_cl_boot, position = position_dodge(width=.9), aes(group=audio_video), color=\"black\")\n\n#propr: very similar in both\nggplot(sixseven_basiclevel_home_data_agg, \n       aes(month, propr, color=audio_video))+\n  geom_violin()+\n  geom_point(position = position_jitterdodge(dodge.width=.9, jitter.width = .1, jitter.height = 0), shape = 21)+\n  stat_summary(fun.data=mean_cl_boot, position = position_dodge(width=.9), aes(group=audio_video), color=\"black\")\n\n#props: very similar in both\nggplot(sixseven_basiclevel_home_data_agg, \n       aes(month, props, color=audio_video))+\n  geom_violin()+\n  geom_point(position = position_jitterdodge(dodge.width=.9, jitter.width = .1, jitter.height = 0), shape = 21)+\n  stat_summary(fun.data=mean_cl_boot, position = position_dodge(width=.9), aes(group=audio_video), color=\"black\")\n\n#type token: 15% higher in video\nggplot(sixseven_basiclevel_home_data_agg, \n       aes(month, type_token_ratio, color=audio_video))+\n  geom_violin()+\n  geom_point(position = position_jitterdodge(dodge.width=.9, jitter.width = .1, jitter.height = 0), shape = 21)+\n  stat_summary(fun.data=mean_cl_boot, position = position_dodge(width=.9), aes(group=audio_video), color=\"black\")\n\n#ent_subj_avg: identical\nggplot(sixseven_basiclevel_home_data_agg, \n       aes(month, ent_subj_av, color=audio_video))+\n  geom_violin()+\n  geom_point(position = position_jitterdodge(dodge.width=.9, jitter.width = .1, jitter.height = 0), shape = 21)+\n  stat_summary(fun.data=mean_cl_boot, position = position_dodge(width=.9), aes(group=audio_video), color=\"black\")\n\n\n```\n\n#actual comparison across audio/video numerically\n\n\n#correlation graphs\n```{r correlation graphs}\nggplot(sixseven_spreadAV,\n       aes(a_numspeakers, v_numspeakers, color=month, fill = month))+\n  geom_point()+\n  stat_smooth()+facet_wrap(~month)\n#corr\nggplot(sixseven_spreadAV,\n       aes(a_numtypes, v_numtypes, color=month, fill = month))+\n  geom_point()+\n  stat_smooth()+facet_wrap(~month)\n\nggplot(sixseven_spreadAV,\n       aes(a_numtokens, v_numtokens, color=month, fill = month))+\n  geom_point()+\n  stat_smooth()+facet_wrap(~month)\n\nggplot(sixseven_spreadAV,\n       aes(a_FAT, v_FAT, color=month, fill = month))+\n  geom_point()+\n  stat_smooth()+facet_wrap(~month)\n#corr\nggplot(sixseven_spreadAV,\n       aes(a_MOT, v_MOT, color=month, fill = month))+\n  geom_point()+\n    stat_smooth()+facet_wrap(~month)\n\ncolnames(sixseven_spreadAV)\n#corr\nggplot(sixseven_spreadAV,\n       aes(a_d, v_d, color=month, fill = month))+\n  geom_point()+\n    stat_smooth()+facet_wrap(~month)\n#corr\nggplot(sixseven_spreadAV,\n       aes(a_q, v_q, color=month, fill = month))+\n  geom_point()+\n    stat_smooth(method=\"rlm\")+facet_wrap(~month)\n#\nggplot(sixseven_spreadAV,\n       aes(a_i, v_i, color=month, fill = month))+\n  geom_point()+\n    stat_smooth()+facet_wrap(~month)\n\nggplot(sixseven_spreadAV,\n       aes(a_n, v_n, color=month, fill = month))+\n  geom_point()+\n    stat_smooth(method=\"rlm\")+facet_wrap(~month)\n\nggplot(sixseven_spreadAV,\n       aes(a_r, v_r, color=month, fill = month))+\n  geom_point()+\n    stat_smooth()+facet_wrap(~month)\n\nggplot(sixseven_spreadAV,\n       aes(a_s, v_s, color=month, fill = month))+\n  geom_point()+\n    stat_smooth()+facet_wrap(~month)\n#crazy spread\nggplot(sixseven_spreadAV,\n       aes(a_TOY, v_TOY, color=month, fill = month))+\n  geom_point()+\n    stat_smooth()+facet_wrap(~month)\n#not corr\nggplot(sixseven_spreadAV,\n       aes(a_prop_op, v_prop_op, color=month, fill = month))+\n  geom_point()+\n    stat_smooth()+facet_wrap(~month)\n\n#corr\nggplot(sixseven_spreadAV,\n       aes(a_prop_mom, v_prop_mom, color=month, fill = month))+\n  geom_point()+\n    stat_smooth()+facet_wrap(~month)\n#sparse\nggplot(sixseven_spreadAV,\n       aes(a_prop_dad, v_prop_dad, color=month, fill = month))+\n  geom_point()+\n    stat_smooth()+facet_wrap(~month)\n#weird dist\nggplot(sixseven_spreadAV,\n       aes(a_prop_parent, v_prop_parent, color=month, fill = month))+\n  geom_point()+\n    stat_smooth()+facet_wrap(~month)\n#sparse\nggplot(sixseven_spreadAV,\n       aes(a_prop_tech, v_prop_tech, color=month, fill = month))+\n  geom_point()+\n    stat_smooth()+facet_wrap(~month)\n\nggplot(sixseven_spreadAV,\n       aes(a_propd, v_propd, color=month, fill = month))+\n  geom_point()+\n    stat_smooth()+facet_wrap(~month)\n\nggplot(sixseven_spreadAV,\n       aes(a_propq, v_propq, color=month, fill = month))+\n  geom_point()+\n    stat_smooth()+facet_wrap(~month)\n\nggplot(sixseven_spreadAV,\n       aes(a_props, v_props, color=month, fill = month))+\n  geom_point()+\n    stat_smooth()+facet_wrap(~month)\n#corr\nggplot(sixseven_spreadAV,\n       aes(a_propi, v_propi, color=month, fill = month))+\n  geom_point()+\n    stat_smooth()+facet_wrap(~month)\n\nggplot(sixseven_spreadAV,\n       aes(a_propn, v_propn, color=month, fill = month))+\n  geom_point()+\n    stat_smooth()+facet_wrap(~month)\n\nggplot(sixseven_spreadAV,\n       aes(a_propr, v_propr, color=month, fill = month))+\n  geom_point()+\n    stat_smooth()+facet_wrap(~month)\n\nggplot(sixseven_spreadAV,\n       aes(a_type_token_ratio, v_type_token_ratio, color=month, fill = month))+\n  geom_point()+\n    stat_smooth(method=\"rlm\")+facet_wrap(~month)\nshapiro.test(sixseven_spreadAV$v_type_token_ratio)\n\nggplot(sixseven_spreadAV,\n       aes(a_ent_subj_av, v_ent_subj_av, color=month, fill = month))+\n  geom_point()+\n    stat_smooth(method=\"rlm\")+facet_wrap(~month)\n```\n\n#distribution of utterance_types\n\n```{r}\n#ut stacked proportionally\nggplot(sixseven_basiclevel_home_data, \n       aes(audio_video, fill = utterance_type))+\n  geom_bar(position = \"fill\")+\n  facet_wrap(~month)\n\n#ut stacked by count\nggplot(sixseven_basiclevel_home_data, \n       aes(audio_video, fill = utterance_type))+\n  geom_bar()+\n  facet_wrap(~month)\n\n\n#op stacked proportionally\nggplot(sixseven_basiclevel_home_data, \n       aes(audio_video, fill = object_present))+\n  geom_bar(position = \"fill\")+\n  facet_wrap(~month)\n\n#op stacked by count\nggplot(sixseven_basiclevel_home_data, \n       aes(audio_video, fill = object_present))+\n  geom_bar()+\n  facet_wrap(~month)\n\n#speaker stacked proportionally\nggplot(sixseven_basiclevel_home_data, \n       aes(audio_video, fill = speaker))+\n  geom_bar(position = \"fill\")+\n  facet_wrap(~month)\n\n#speaker stacked by count\nggplot(sixseven_basiclevel_home_data, \n       aes(audio_video, fill = speaker))+\n  geom_bar()+\n  facet_wrap(~month)\n```\n\n#Top Words\n```{r top words}\n#collapsing month\ntop100av <- sixseven_basiclevel_home_data%>%\n  group_by(audio_video, object)%>%\n  tally()%>%\n  top_n(100,n)\n\ntop100av_spread <- top100av %>% \n  spread(audio_video, n,fill = 0) %>% \n  group_by(object) %>% \n  mutate(aud_vid_sum = sum(audio,video, na.rm=T)) %>% \n  arrange(-aud_vid_sum)\n\ncor.test(top100av_spread$audio, top100av_spread$video, method = \"spearman\")# sig cor, but ~1/3 are 0s in each\n\n\ntop100av67 <- sixseven_basiclevel_home_data%>%\n   group_by(audio_video, month,object)%>%\n  tally() %>% \n#   group_by(object)%>%\n#   summarise(n = n(),\n#             nfams = n_distinct(subj)) %>% \n#   #filter(nfams>11) %>% #only including words that 25% the families heard in that recording-type and month\n#   #dplyr::select(-nfams) %>% #but then removing this var for further spreading below\n#   #ungroup() %>% \n#   #group_by(audio_video, month) %>%\n   top_n(100,n) %>%\n#   arrange(-nfams, n) %>% \n#   filter(!(nfams==1 & n==1)& nfams>1) %>% \n  arrange(audio_video, month, -n)\n\n\n  \n#uncollapsing month\n# top100av <- sixseven_basiclevel_home_data%>%\n#   group_by(audio_video, object, month)%>%\n#   tally()%>%\n#   top_n(100,n)\n# View(top100av)\n# \n# top100av_spread <- top100av %>% \n#   spread(audio_video, n,fill = 0) %>% \n#   group_by(object) %>% \n#   mutate(aud_vid_sum = sum(audio,video, na.rm=T)) %>% \n#   arrange(-aud_vid_sum)\n\ntop100av67_avspread <- top100av67 %>% \n  spread(audio_video, n, fill = 0) %>% \n  group_by(object, month) %>% \n  mutate(aud_vid_sum = sum(audio,video, na.rm=T)) %>% \n  arrange(-aud_vid_sum)\n\ntop100av67_avspread %>% \n  mutate(zeroA_V= ifelse(audio==0|video==0,T,F)) %>% \n  group_by(zeroA_V) %>% \n  tally()\n\ntop100audio_monthspread <- top100av67_avspread %>% \n  dplyr::select(-video, -aud_vid_sum) %>% \n  spread(month, audio, fill = 0) %>% \n  rename(six = `06`,\n         seven = `07`) %>% \n  filter(!(six==0 & seven==0)) %>% \n  mutate(audio_video=\"audio\")\n\ntop100video_monthspread <- top100av67_avspread %>% \n  dplyr::select(-audio, -aud_vid_sum) %>% \n  spread(month, video, fill = 0) %>% \n  rename(six = `06`,\n         seven = `07`) %>% \n  filter(!(six==0 & seven==0)) %>% \n  mutate(audio_video=\"video\")\ntop100_monthspread <- bind_rows(top100audio_monthspread, top100video_monthspread)\n\n#could holmes adjust these as needed\n\ncor.test(subset(top100av67_avspread, month==\"06\")$audio, subset(top100av67_avspread, month==\"06\")$video, method = \"spearman\")\ncor.test(subset(top100av67_avspread, month==\"07\")$audio, subset(top100av67_avspread, month==\"07\")$video, method = \"spearman\")\ncor.test(top100audio_monthspread$six, top100audio_monthspread$seven, method = \"spearman\")\ncor.test(top100video_monthspread$six, top100video_monthspread$seven, method = \"spearman\")\ncor.test(top100av_spread$audio, top100av_spread$video, method = \"spearman\")\n\n#cor top100 by month a vs. v\nggplot(top100av67_avspread, aes(audio, video))+facet_wrap(~month)+geom_point(shape=1)\nggplot(top100_monthspread, aes(six, seven))+facet_wrap(~audio_video, scales = \"free\")+geom_point(shape =1)\n\n\n```\n## Word Tallies\n```{r word tallies}\n#unique object words across months and recordings types\noverall_tally <- sixseven_basiclevel_home_data %>% \n  group_by(basic_level) %>%\n  tally() %>% \n  arrange(-n)\n\nggplot(overall_tally %>% filter(n>1), aes(n))+geom_histogram()+scale_y_log10()+scale_x_log10()\n#that happen more than in once\nsixseven_basiclevel_home_data %>% \n  group_by(object) %>% \n  tally() %>% \n  filter(n>1)\n\ntally_month_av<- sixseven_basiclevel_home_data %>% \n  group_by(object,audio_video, month) %>%\n  tally() %>% \n  arrange(-n)\nggplot(tally_month_av, aes(n, fill = month))+geom_histogram()+\n  facet_grid(month~audio_video,scales = \"free\")+\n  scale_x_log10()+scale_y_log10()\n\nggplot(filter(tally_month_av, n>10), aes(n, fill = month))+geom_histogram()+\n  facet_grid(audio_video~month,scales = \"free\")+scale_x_log10()\n\n#unique within audio\naudiounique <- sixseven_basiclevel_home_data %>% \n  filter(audio_video==\"audio\") %>% \n  group_by(object) %>%\n  tally() %>% \n  arrange(-n)\n\n\n#that happen more than in once within audio\nsixseven_basiclevel_home_data %>% \n  filter(audio_video==\"audio\") %>% \n  group_by(object) %>% \n  tally() %>% \n  filter(n>1)\n\n#unique within video\nvideounique <- sixseven_basiclevel_home_data %>% \n  filter(audio_video==\"video\") %>% \n  group_by(object) %>%\n  tally()\n\n#that happen more than in once within video\nsixseven_basiclevel_home_data %>% \n  filter(audio_video==\"video\") %>% \n  group_by(object) %>% \n  tally() %>% \n  filter(n>1)\n\n#audio that is not in video\n#video that is not in audio\n#1847 words occured in audio more than once but video never\naudiounique %>% \n  filter(!object%in% videounique$object & n>1)\n\n#of which 265 were proper nouns\naudiounique %>% \n  filter(!object%in% videounique$object & n>1) %>% \n  mutate(cap = ifelse(tolower(object)!=object, T, F)) %>% \n  group_by(cap) %>% \n  dplyr::select(-n) %>% \n  tally()\n\n#201 words occured in video more than once but audio never\nvideounique %>% \n  filter(!object%in% audiounique$object & n>1) %>% \n  mutate(cap = ifelse(tolower(object)!=object, T, F))\n\n#of which 76 were proper nouns\nvideounique %>% \n  filter(!object%in% audiounique$object & n>1) %>% \n  mutate(cap = ifelse(tolower(object)!=object, T, F)) %>% \n  group_by(cap) %>% \n  dplyr::select(-n) %>% \n  tally()\n```\n\n```{r tallying graphs}\n#top100 graph, log space\nggplot(top100av_spread, aes(audio+.1, video+.1, color = (audio==0 |video==0)))+\n  geom_label_repel(aes(label=object),label.size = .10,\n  label.padding = unit(0.1, \"lines\"),\n  segment.color = \"grey90\")+\n  theme_bw(base_size=18)+\n  guides(colour=F)+scale_x_log10()+scale_y_log10()\n\nggplot(persubj_month_top1, aes(subj, n, color= object, label = object))+\n  geom_label()+theme_bw(base_size=12)+\n  #geom_label_repel()+\n  guides(color=F)+facet_grid(audio_video~month, scales = \"free\")\n\noverall_month_top10 <-sixseven_basiclevel_home_data%>%\n  group_by(audio_video, month, object)%>%\n  summarise(n = n(),\n            nfams = n_distinct(subj)) %>% \n  top_n(10,n) %>% \n  arrange(audio_video, month, -n)\n\n#overall_month_top10 %>% View()\n#top 10 by av and by month\nggplot(overall_month_top10, aes(n, nfams, label = object, colour = audio_video, fill = object))+\n  facet_wrap(~month)+\n  geom_label_repel(segment.color = \"grey50\")+\n  theme_bw(base_size=18)+\n  scale_colour_manual(values = c(\"white\",\"black\"))+\n  guides(fill=F)\n  \n\n\nggplot(top50av67_avspread, aes(audio, video, color = (audio==0 |video==0)))+\n  geom_label_repel(aes(label=object),label.size = .10,\n  label.padding = unit(0.1, \"lines\"), size = 3,\n  point.padding = unit(1.6, 'lines'),\n  segment.color = '#cccccc',\n  segment.alpha =.5,\n  force=.5, fill = \"white\")+\n#  nudge_x = ifelse(top100av67_avspread$video == 0, 10, \n#                   ifelse(top100av67_avspread$audio ==0, -10, 0)),\n#  nudge_y = ifelse(top100av67_avspread$video == 0, -40, \n#                   ifelse(top100av67_avspread$audio ==0, 20, 0)))+\n      #arrow = arrow(length = unit(0.02, 'npc')))+\n  theme_bw(base_size=14)+\n  guides(color=F)+facet_wrap(~month, nrow=1)+\n  geom_point()\n\n\n\n\nggplot(hist_sixseven, aes(n, fill=audio_video))+geom_histogram(binwidth=100)+facet_wrap(month~audio_video, scales =\"free\")\n```\n\n```{r sixseven_spreadmonth graphs}\nggplot(sixseven_spreadmonth, aes(six_numspeakers, sev_numspeakers))+geom_point()+stat_smooth()+facet_wrap(~audio_video, scales = \"free\", nrow  =2)\nggplot(sixseven_spreadmonth, aes(six_numtypes, sev_numtypes))+geom_point()+stat_smooth()+facet_wrap(~audio_video, scales = \"free\", nrow  =2)\nggplot(sixseven_spreadmonth, aes(six_FAT, sev_FAT))+geom_point()+stat_smooth()+facet_wrap(~audio_video, scales = \"free\", nrow  =2)\nggplot(sixseven_spreadmonth, aes(six_MOT, sev_MOT))+geom_point()+stat_smooth()+facet_wrap(~audio_video, scales = \"free\", nrow  =2)\nggplot(sixseven_spreadmonth, aes(six_d, sev_d))+geom_point()+stat_smooth()+facet_wrap(~audio_video, scales = \"free\", nrow  =2)\nggplot(sixseven_spreadmonth, aes(six_q, sev_q))+geom_point()+stat_smooth()+facet_wrap(~audio_video, scales = \"free\", nrow  =2)\nggplot(sixseven_spreadmonth, aes(six_i, sev_i))+geom_point()+stat_smooth()+facet_wrap(~audio_video, scales = \"free\", nrow  =2)\nggplot(sixseven_spreadmonth, aes(six_r, sev_r))+geom_point()+stat_smooth()+facet_wrap(~audio_video, scales = \"free\", nrow  =2)\nggplot(sixseven_spreadmonth, aes(six_s, sev_s))+geom_point()+stat_smooth()+facet_wrap(~audio_video, scales = \"free\", nrow  =2)\nggplot(sixseven_spreadmonth, aes(six_n, sev_n))+geom_point()+stat_smooth()+facet_wrap(~audio_video, scales = \"free\", nrow  =2)\n```\n\n#stats\n```{r anovas}\n#need to redo as moving window\nlm_quant_prop <- lm(data = sixseven_basiclevel_home_data_agg, type_token_ratio ~ month + audio_video)\nanova(lm_quant_prop)\nplot(lm_quant_prop)\nsummary(lm_quant_prop)\n\nsixseven_basiclevel_home_data_agg %>% \n  group_by(month, audio_video)%>%\n  summarise(mean(type_token_ratio))\n\n#sixseven_spreadAV %>% \nsixseven_basiclevel_home_data_agg %>% \n  group_by(month, audio_video)%>%\n  summarise(median(numspeakers, na.rm=T),\n            mean(numspeakers, na.rm=T),\n            sd(numspeakers, na.rm=T))\n\n\nsixseven_basiclevel_home_data_agg %>% \n  group_by(month, audio_video)%>%\n  summarise(median(FAT, na.rm=T),\n            mean(FAT, na.rm=T),\n            sd(FAT, na.rm=T))\n# none of the audio differences 6 vs 7 are different\nwa1 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$numtokens,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$numtokens, conf.int=T, paired = T)\nwa2 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$numtypes,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$numtypes, conf.int=T, paired = T)\nwa3 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$numspeakers,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$numspeakers, conf.int=T, paired = T)\nwa4 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$MOT,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$MOT, conf.int=T, paired = T)\nwa5 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$FAT,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$FAT, conf.int=T, paired = T)\nwa6 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$d,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$d, conf.int=T, paired = T)\nwa7 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$q,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$q, conf.int=T, paired = T)\nwa8 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$r,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$r, conf.int=T, paired = T)\nwa9 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$i,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$i, conf.int=T, paired = T)\nwa10 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$n,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$n, conf.int=T, paired = T)\nwa11 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$s,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$s, conf.int=T, paired = T)\nwa12 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$y_op,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$n_op, conf.int=T, paired = T)\n\n#most video 6vs7 aren't different\nwv1 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$numtokens,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$numtokens, conf.int=T, paired = T)\nwv2 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$numtypes,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$numtypes, conf.int=T, paired = T)\nwv3 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$numspeakers,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$numspeakers, conf.int=T, paired = T)\nwv4 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$MOT,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$MOT, conf.int=T, paired = T)\nwv5 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$d,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$d, conf.int=T, paired = T)\nwv6 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$r,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$r, conf.int=T, paired = T)\nwv7 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$i,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$i, conf.int=T, paired = T)\nwv8 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$y_op,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$y_op, conf.int=T, paired = T)\nwv9 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$q,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$q, conf.int=T, paired = T)\nwv10 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$n,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$n, conf.int=T, paired = T)\nwv11 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$s,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$s, conf.int=T, paired = T)\nwv12 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\" & subj!=\"17\")$FAT,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\" & subj!=\"17\")$FAT, conf.int=T, paired = T)\n```\n```{r cor tests 6 vs 7}\n# none of the audio differences 6 vs 7 are different\nca1 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$numtokens,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$numtokens, conf.int=T, method = \"kendall\")\nca2 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$numtypes,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$numtypes, conf.int=T, method = \"kendall\")\nca3 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$numspeakers,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$numspeakers, conf.int=T, method = \"kendall\")\nca4 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$MOT,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$MOT, conf.int=T, method = \"kendall\")\nca5 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$FAT,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$FAT, conf.int=T, method = \"kendall\")\nca6 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$d,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$d, conf.int=T, method = \"kendall\")\nca7 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$q,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$q, conf.int=T, method = \"kendall\")\nca8 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$r,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$r, conf.int=T, method = \"kendall\")\nca9 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$i,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$i, conf.int=T, method = \"kendall\")\nca10 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$n,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$n, conf.int=T, method = \"kendall\")\nca11 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$s,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$s, conf.int=T, method = \"kendall\")\nca12 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$y_op,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$n_op, conf.int=T, method = \"kendall\")\n\n#most video 6vs7 aren't different\ncv1 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$numtokens,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$numtokens, conf.int=T, method = \"kendall\")\ncv2 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$numtypes,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$numtypes, conf.int=T, method = \"kendall\")\ncv3 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$numspeakers,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$numspeakers, conf.int=T, method = \"kendall\")\ncv4 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$MOT,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$MOT, conf.int=T, method = \"kendall\")\ncv5 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$d,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$d, conf.int=T, method = \"kendall\")\ncv6 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$r,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$r, conf.int=T, method = \"kendall\")\ncv7 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$i,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$i, conf.int=T, method = \"kendall\")\ncv8 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$y_op,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$y_op, conf.int=T, method = \"kendall\")\ncv9 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$q,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$q, conf.int=T, method = \"kendall\")\ncv10 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$n,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$n, conf.int=T, method = \"kendall\")\ncv11 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$s,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$s, conf.int=T, method = \"kendall\")\ncv12 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\" & subj!=\"17\")$FAT,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\" & subj!=\"17\")$FAT, conf.int=T, method = \"kendall\")\n\ncv_ps <- cbind(cv1$p.value,cv2$p.value,cv3$p.value, cv4$p.value, cv5$p.value, cv6$p.value, cv7$p.value, cv8$p.value, cv9$p.value, cv10$p.value, cv11$p.value, cv12$p.value)\nround(p.adjust(cv_ps, method = \"holm\"),3)\nround(cv_ps,3)\ntable(cv_ps<.05)\ntable(p.adjust(cv_ps, method = \"holm\")<.05)\ncv6\n#taking out cv7 bc it's not sig, reading count\ncv_taus <- cbind(cv1$estimate,cv2$estimate,cv3$estimate, cv4$estimate, cv5$estimate, cv6$estimate, cv8$estimate, cv9$estimate, cv10$estimate, cv11$estimate, cv12$estimate)\nrange(cv_taus)\n\n\nca_ps <- cbind(ca1$p.value,ca2$p.value,ca3$p.value, ca4$p.value, ca5$p.value, ca6$p.value, ca7$p.value, ca8$p.value, ca9$p.value, ca10$p.value, ca11$p.value, ca12$p.value)\nround(p.adjust(ca_ps, method = \"holm\"),3)\nround(ca_ps, 3)\ntable(ca_ps<.05)\ntable(p.adjust(ca_ps, method = \"holm\")<.05)\n\nwv_ps <- cbind(wv1$p.value,wv2$p.value,wv3$p.value, wv4$p.value, wv5$p.value, wv6$p.value, wv7$p.value, wv8$p.value, wv9$p.value, wv10$p.value, wv11$p.value, wv12$p.value)\nround(p.adjust(wv_ps, method = \"holm\"),3)\nround(wv_ps, 3)\ntable(wv_ps<.05)\ntable(p.adjust(wv_ps, method = \"holm\")<.05)\n\nca_taus <- cbind(ca1$estimate,ca2$estimate,ca3$estimate, ca4$estimate, ca5$estimate, ca6$estimate, ca7$estimate, ca8$estimate, ca9$estimate, ca10$estimate, ca11$estimate, ca12$estimate)\nrange(ca_taus)\n\n\nwa_ps <- cbind(wa1$p.value,wa2$p.value,wa3$p.value, wa4$p.value, wa5$p.value, wa6$p.value, wa7$p.value, wa8$p.value, wa9$p.value, wa10$p.value, wa11$p.value, wa12$p.value)\nround(p.adjust(wa_ps, method = \"holm\"),3)\nround(wa_ps, 3)\ntable(wa_ps<.05)\ntable(p.adjust(wa_ps, method = \"holm\")<.05)\n\nsixseven_basiclevel_home_data_agg%>%\n  group_by(audio_video) %>% \n  summarise(meantokens = mean(numtokens, na.rm=T),\n    meantokens_hour = mean(as.numeric(as.character(ifelse(audio_video==\"audio\", numtokens/11, numtokens))), na.rm=T))\n\n```\n\n```{r 6vs 7 prop measures wilcox}\n# none of the audio differences 6 vs 7 are different\npwa1 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$prop_op,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$prop_op, conf.int=T, paired = T)\npwa2 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$prop_mom,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$prop_mom, conf.int=T, paired = T)\npwa3 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$prop_dad,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$prop_dad, conf.int=T, paired = T)\npwa4 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$propd,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$propd, conf.int=T, paired = T)\npwa5 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$propi,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$propi, conf.int=T, paired = T)\npwa6 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$propr,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$propr, conf.int=T, paired = T)\npwa7 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$propq,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$propq, conf.int=T, paired = T)\npwa8 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$props,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$props, conf.int=T, paired = T)\npwa9 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$propn,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$propn, conf.int=T, paired = T)\npwa10 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$type_token_ratio,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$type_token_ratio, conf.int=T, paired = T)\n\n#most video 6vs7 aren't different\npwv1 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$prop_op,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$prop_op, conf.int=T, paired = T)\npwv2 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$prop_mom,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$prop_mom, conf.int=T, paired = T)\npwv3 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$prop_dad,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$prop_dad, conf.int=T, paired = T)\npwv4 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$propd,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$propd, conf.int=T, paired = T)\npwv5 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$propi,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$propi, conf.int=T, paired = T)\npwv6 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$propr,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$propr, conf.int=T, paired = T)\npwv7 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$propq,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$propq, conf.int=T, paired = T)\npwv8 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$props,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$props, conf.int=T, paired = T)\npwv9 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$propn,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$propn, conf.int=T, paired = T)\npwv10 <- wilcox.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$type_token_ratio,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$type_token_ratio, conf.int=T, paired = T)\n```\n\n```{r cor tests 6 vs 7 prop measures}\n# none of the audio differences 6 vs 7 are different\npca1 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$prop_op,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$prop_op, conf.int=T, method = \"kendall\")\npca2 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$prop_mom,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$prop_mom, conf.int=T, method = \"kendall\")\npca3 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$prop_dad,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$prop_dad, conf.int=T, method = \"kendall\")\npca4 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$propd,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$propd, conf.int=T, method = \"kendall\")\npca5 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$propi,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$propi, conf.int=T, method = \"kendall\")\npca6 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$propr,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$propr, conf.int=T, method = \"kendall\")\npca7 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$propq,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$propq, conf.int=T, method = \"kendall\")\npca8 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$props,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$props, conf.int=T, method = \"kendall\")\npca9 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$propn,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$propn, conf.int=T, method = \"kendall\")\npca10 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"06\")$type_token_ratio,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"audio\" & month==\"07\")$type_token_ratio, conf.int=T, method = \"kendall\")\n\n#most video 6vs7 aren't different\npcv1 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$prop_op,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$prop_op, conf.int=T, method = \"kendall\")\npcv2 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$prop_mom,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$prop_mom, conf.int=T, method = \"kendall\")\npcv3 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$prop_dad,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$prop_dad, conf.int=T, method = \"kendall\")\npcv4 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$propd,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$propd, conf.int=T, method = \"kendall\")\npcv5 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$propi,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$propi, conf.int=T, method = \"kendall\")\npcv6 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$propr,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$propr, conf.int=T, method = \"kendall\")\npcv7 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$propq,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$propq, conf.int=T, method = \"kendall\")\npcv8 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$props,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$props, conf.int=T, method = \"kendall\")\npcv9 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$propn,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$propn, conf.int=T, method = \"kendall\")\npcv10 <- cor.test(subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"06\"& subj!=\"17\")$type_token_ratio,\n            subset(sixseven_basiclevel_home_data_agg, audio_video==\"video\" & month==\"07\"& subj!=\"17\")$type_token_ratio, conf.int=T, method = \"kendall\")\n\npcv_ps <- cbind(pcv1$p.value,pcv2$p.value,pcv3$p.value, pcv4$p.value, pcv5$p.value, pcv6$p.value, pcv7$p.value, pcv8$p.value, pcv9$p.value, pcv10$p.value)\nround(p.adjust(pcv_ps, method = \"holm\"),3)#prop_mom, prop_dad, \nround(pcv_ps,3)\ntable(pcv_ps<.05)\ntable(p.adjust(pcv_ps, method = \"holm\")<.05)\n\npcv2 \npcv3 \n\npca_ps <- cbind(pca1$p.value,pca2$p.value,pca3$p.value, pca4$p.value, pca5$p.value, pca6$p.value, pca7$p.value, pca8$p.value, pca9$p.value, pca10$p.value)\nround(p.adjust(pca_ps, method = \"holm\"),3)# 2,3,4,5,6,8,10: all but propop, propq, and propn\nround(pca_ps, 3)\ntable(pca_ps<.05)\ntable(p.adjust(pca_ps, method = \"holm\")<.05)\n\n#removing 1 7 and 9 bc ns\npca_taus <- cbind(pca2$estimate,pca3$estimate, pca4$estimate, pca5$estimate, pca6$estimate, pca8$estimate, pca10$estimate)\nrange(pca_taus)\n\npwv_ps <- cbind(pwv1$p.value,pwv2$p.value,pwv3$p.value, pwv4$p.value, pwv5$p.value, pwv6$p.value, pwv7$p.value, pwv8$p.value, pwv9$p.value, pwv10$p.value)\nround(p.adjust(pwv_ps, method = \"holm\"),3)\nround(pwv_ps, 3)\ntable(pwv_ps<.05)\ntable(p.adjust(pwv_ps, method = \"holm\")<.05)\n# none of them differ\n\npwa_ps <- cbind(pwa1$p.value,pwa2$p.value,pwa3$p.value, pwa4$p.value, pwa5$p.value, pwa6$p.value, pwa7$p.value, pwa8$p.value, pwa9$p.value, pwa10$p.value)\nround(p.adjust(pwa_ps, method = \"holm\"),3)\nround(pwa_ps, 3)\ntable(pwa_ps<.05)\ntable(p.adjust(pwa_ps, method = \"holm\")<.05)\n\n```\n\n\n\n```{r wilcox tests AV prop}\n#most six props aren't different\npropwsix1 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month==\"06\"& subj!=\"17\"), prop_op~audio_video, conf.int=T, paired = T)\npropwsix2 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month==\"06\"& subj!=\"17\"), prop_mom~audio_video, conf.int=T, paired = T)\npropwsix3 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month==\"06\"& subj!=\"17\"), prop_dad~audio_video, conf.int=T, paired = T)\npropwsix4 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month==\"06\"& subj!=\"17\"), propd~audio_video, conf.int=T, paired = T)\npropwsix5 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month==\"06\"& subj!=\"17\"), propi~audio_video, conf.int=T, paired = T)\npropwsix6 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month==\"06\"& subj!=\"17\"), propr~audio_video, conf.int=T, paired = T)\npropwsix7 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month==\"06\"& subj!=\"17\"), propq~audio_video, conf.int=T, paired = T)\npropwsix8 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month==\"06\"& subj!=\"17\"), props~audio_video, conf.int=T, paired = T)\npropwsix9 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month==\"06\"& subj!=\"17\"), propn~audio_video, conf.int=T, paired = T)\npropwsix10 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month==\"06\"& subj!=\"17\"), type_token_ratio~audio_video, conf.int=T, paired = T)\n\npropwsix_ps <- cbind(propwsix1$p.value,propwsix2$p.value,propwsix3$p.value, propwsix4$p.value, propwsix5$p.value, propwsix6$p.value, propwsix7$p.value, propwsix8$p.value, propwsix9$p.value, propwsix10$p.value)\nround(p.adjust(propwsix_ps, method = \"holm\"),3) #1, 4,7, 10: prop_op, propd, propq, and ttr\nround(propwsix_ps, 3)\ntable(propwsix_ps<.05)\ntable(p.adjust(propwsix_ps, method = \"holm\")<.05)\npropwsix_estdiff <- cbind(propwsix1$estimate,propwsix2$estimate,propwsix3$estimate, propwsix4$estimate, propwsix5$estimate, propwsix6$estimate, propwsix7$estimate, propwsix8$estimate, propwsix9$estimate, propwsix10$estimate)\nrange((propwsix_estdiff))\nmedian(propwsix_estdiff)\nmean(propwsix_estdiff)\n\n\n#most seven props aren't different\npropwseven1 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month==\"07\"), prop_op~audio_video, conf.int=T, paired = T)\npropwseven2 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month==\"07\"), prop_mom~audio_video, conf.int=T, paired = T)\npropwseven3 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month==\"07\"), prop_dad~audio_video, conf.int=T, paired = T)\npropwseven4 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month==\"07\"), propd~audio_video, conf.int=T, paired = T)\npropwseven5 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month==\"07\"), propi~audio_video, conf.int=T, paired = T)\npropwseven6 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month==\"07\"), propr~audio_video, conf.int=T, paired = T)\npropwseven7 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month==\"07\"), propq~audio_video, conf.int=T, paired = T)\npropwseven8 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month==\"07\"), props~audio_video, conf.int=T, paired = T)\npropwseven9 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month==\"07\"), propn~audio_video, conf.int=T, paired = T)\npropwseven10 <- wilcox.test(data = subset(sixseven_basiclevel_home_data_agg, month==\"07\"), type_token_ratio~audio_video, conf.int=T, paired = T)\n\npropwseven_ps <- cbind(propwseven1$p.value,propwseven2$p.value,propwseven3$p.value, propwseven4$p.value, propwseven5$p.value, propwseven6$p.value, propwseven7$p.value, propwseven8$p.value, propwseven9$p.value, propwseven10$p.value)\nround(p.adjust(propwseven_ps, method = \"holm\"),3) #1, 2,3,4,7,10: prop_op, prop_mom, prop_dad, propd, propq, and ttr\nround(propwseven_ps, 3)\ntable(propwseven_ps<.05)\ntable(p.adjust(propwseven_ps, method = \"holm\")<.05)\n\npropwseven_estdiff <- cbind(propwseven1$estimate,propwseven2$estimate,propwseven3$estimate, propwseven4$estimate, propwseven5$estimate, propwseven6$estimate, propwseven7$estimate, propwseven8$estimate, propwseven9$estimate, propwseven10$estimate)\nrange((propwseven_estdiff))\nmedian(propwseven_estdiff)\nmean(propwseven_estdiff)\n\n```\n\n```{r prop AV cor tests}\n#only propi is correlated at 6 months, audio to video\npropcsix1 <- cor.test(data=subset(sixseven_spreadAV, month==\"06\"& subj!=\"17\"), ~v_prop_op+a_prop_op,conf.int=T, method = \"kendall\")\npropcsix2 <- cor.test(data=subset(sixseven_spreadAV, month==\"06\"& subj!=\"17\"), ~v_prop_mom+a_prop_mom,conf.int=T, method = \"kendall\")\npropcsix3 <- cor.test(data=subset(sixseven_spreadAV, month==\"06\"& subj!=\"17\"), ~v_prop_dad+a_prop_dad,conf.int=T, method = \"kendall\")\npropcsix4 <- cor.test(data=subset(sixseven_spreadAV, month==\"06\"& subj!=\"17\"), ~v_propd+a_propd,conf.int=T, method = \"kendall\")\npropcsix5 <- cor.test(data=subset(sixseven_spreadAV, month==\"06\"& subj!=\"17\"), ~v_propi+a_propi,conf.int=T, method = \"kendall\")\npropcsix6 <- cor.test(data=subset(sixseven_spreadAV, month==\"06\"& subj!=\"17\"), ~v_propr+a_propr,conf.int=T, method = \"kendall\")\npropcsix7 <- cor.test(data=subset(sixseven_spreadAV, month==\"06\"& subj!=\"17\"), ~v_propq+a_propq,conf.int=T, method = \"kendall\")\npropcsix8 <- cor.test(data=subset(sixseven_spreadAV, month==\"06\"& subj!=\"17\"), ~v_props+a_props,conf.int=T, method = \"kendall\")\npropcsix9 <- cor.test(data=subset(sixseven_spreadAV, month==\"06\"& subj!=\"17\"), ~v_propn+a_propn,conf.int=T, method = \"kendall\")\npropcsix10 <- cor.test(data=subset(sixseven_spreadAV, month==\"06\"& subj!=\"17\"), ~v_type_token_ratio+a_type_token_ratio,conf.int=T, method = \"kendall\")\n\npropcsix_ps <- cbind(propcsix1$p.value,propcsix2$p.value,propcsix3$p.value, propcsix4$p.value, propcsix5$p.value, propcsix6$p.value, propcsix7$p.value, propcsix8$p.value, propcsix9$p.value, propcsix10$p.value)\nround(p.adjust(propcsix_ps, method = \"holm\"),3) #only propi\nround(propcsix_ps, 3)\ntable(propcsix_ps<.05)\ntable(p.adjust(propcsix_ps, method = \"holm\")<.05)\npropcsix5\n\n#4 seven props a vs. v are correlated\npropcseven1 <- cor.test(data=subset(sixseven_spreadAV, month==\"07\"), ~v_prop_op+a_prop_op,conf.int=T, method = \"kendall\")\npropcseven2 <- cor.test(data=subset(sixseven_spreadAV, month==\"07\"), ~v_prop_mom+a_prop_mom,conf.int=T, method = \"kendall\")\npropcseven3 <- cor.test(data=subset(sixseven_spreadAV, month==\"07\"), ~v_prop_dad+a_prop_dad,conf.int=T, method = \"kendall\")\npropcseven4 <- cor.test(data=subset(sixseven_spreadAV, month==\"07\"), ~v_propd+a_propd,conf.int=T, method = \"kendall\")\npropcseven5 <- cor.test(data=subset(sixseven_spreadAV, month==\"07\"), ~v_propi+a_propi,conf.int=T, method = \"kendall\")\npropcseven6 <- cor.test(data=subset(sixseven_spreadAV, month==\"07\"), ~v_propr+a_propr,conf.int=T, method = \"kendall\")\npropcseven7 <- cor.test(data=subset(sixseven_spreadAV, month==\"07\"), ~v_propq+a_propq,conf.int=T, method = \"kendall\")\npropcseven8 <- cor.test(data=subset(sixseven_spreadAV, month==\"07\"), ~v_props+a_props,conf.int=T, method = \"kendall\")\npropcseven9 <- cor.test(data=subset(sixseven_spreadAV, month==\"07\"), ~v_propn+a_propn,conf.int=T, method = \"kendall\")\npropcseven10 <- cor.test(data=subset(sixseven_spreadAV, month==\"07\"), ~v_type_token_ratio+a_type_token_ratio,conf.int=T, method = \"kendall\")\n\npropcseven_ps <- cbind(propcseven1$p.value,propcseven2$p.value,propcseven3$p.value, propcseven4$p.value, propcseven5$p.value, propcseven6$p.value, propcseven7$p.value, propcseven8$p.value, propcseven9$p.value, propcseven10$p.value)\nround(p.adjust(propcseven_ps, method = \"holm\"),3) #2,3,4,6: propmom, propdad, propd, propr\nround(propcseven_ps, 3)\ntable(propcseven_ps<.05)\ntable(p.adjust(propcseven_ps, method = \"holm\")<.05)\n\npropcseven_taus <- cbind(propcseven2$estimate,propcseven3$estimate, propcseven4$estimate, propcseven6$estimate) \nrange(propcseven_taus)\n\n\n\n```\n\n```{r}\n\n\n# propvals_med <- sixseven_basiclevel_home_data_agg %>% \n#   dplyr::select(month, audio_video, prop_op, prop_mom, prop_dad, propd, propi, propn, propq, propr, props, type_token_ratio) %>% \n#   group_by(month, audio_video) %>% \n#   #summarise_if(is.numeric, funs(min, max, mean, median))\n#   summarise_if(is.numeric, funs(median)) %>% \n#   gather(prop_meas, medianval, prop_op:type_token_ratio)\n# \n# propvals_mean <- sixseven_basiclevel_home_data_agg %>% \n#   dplyr::select(month, audio_video, prop_op, prop_mom, prop_dad, propd, propi, propn, propq, propr, props, type_token_ratio) %>% \n#   group_by(month, audio_video) %>% \n#   #summarise_if(is.numeric, funs(min, max, mean, median))\n#   summarise_if(is.numeric, funs(mean)) %>% \n#   gather(prop_meas, meanval, prop_op:type_token_ratio)\n\npropvals_long <- sixseven_basiclevel_home_data_agg %>% \n  dplyr::select(month, audio_video, subj, prop_op, prop_mom, prop_dad, propd, propq, propn, props, propr, propi, type_token_ratio) %>% \n  group_by(month, audio_video, subj) %>% \n  gather(prop_meas, propval, prop_op:type_token_ratio) %>% \n  mutate(prop_meas=factor(prop_meas),\n         prop_meas = fct_relevel(prop_meas,\n                                  c(\"prop_op\", \"prop_mom\", \"prop_dad\", \"propd\", \"propq\", \"propn\", \"props\", \"propr\", \"propi\",\"type_token_ratio\")),\nmeas_type = fct_collapse(prop_meas,\n                                  speaker = c(\"prop_mom\",\"prop_dad\"),\n                                  utt = c(\"propd\",\"propq\",\"propn\",\"props\",\"propr\",\"propi\"),\n                                  quant = \"type_token_ratio\",\n                                  op = \"prop_op\"))\n\ncountvals_long <- sixseven_basiclevel_home_data_agg %>% \n  dplyr::select(month, audio_video, subj, y_op, MOT, FAT, d, q, n, s, r, i, numtypes, numtokens, numspeakers) %>% \n  group_by(month, audio_video, subj) %>% \n  gather(count_meas, countval, y_op:numspeakers) %>% \n  mutate(count_meas=factor(count_meas),\n         count_meas = fct_relevel(count_meas,\n                                  c(\"y_op\", \"MOT\", \"FAT\", \"d\", \"q\", \"n\", \"s\", \"r\", \"i\", \"numtypes\", \"numtokens\", \"numspeakers\")),\n    meas_type = fct_collapse(count_meas,\n                                  speaker = c(\"MOT\",\"FAT\"),\n                                  speaker_num = c(\"numspeakers\"),\n                                  utt = c(\"d\",\"q\",\"n\",\"s\",\"r\",\"i\"),\n                                  quant = c(\"numtypes\",\"numtokens\"),\n                                  op = \"y_op\"))\n\n\n# ggplot(propvals_med, aes(fill = prop_meas, linetype=audio_video,prop_meas, medianval))+\n#   facet_wrap(month~audio_video,ncol=1)+geom_bar(stat=\"identity\", color = \"black\")\n# ggplot(propvals_med, aes(fill = prop_meas, linetype=audio_video, month, medianval))+\n#   geom_bar(stat=\"identity\", color = \"black\", position =\"dodge\")\n\n# ggplot(propvals_mean, aes(fill = prop_meas, linetype=audio_video, month, meanval))+\n#   geom_bar(stat=\"identity\", color = \"black\", position =\"dodge\")\nggplot(propvals_long, aes(fill = prop_meas, linetype =audio_video, month, propval))+\n  stat_summary(fun.y=mean, geom=\"bar\", position = \"dodge\", aes(linetype=audio_video),color = \"black\")+\n  stat_summary(fun.data=mean_cl_boot, geom=\"pointrange\", position=position_dodge(width=.9), \n               aes(group = interaction(prop_meas,month,audio_video)))+\n  facet_wrap(~meas_type, nrow = 2, scales = \"free_y\")\n\nggplot(countvals_long, aes(fill = count_meas, linetype =audio_video, month, countval))+\n  stat_summary(fun.y=mean, geom=\"bar\", position = \"dodge\", aes(linetype=audio_video), color = \"black\")+\n  stat_summary(fun.data=mean_cl_boot, geom=\"pointrange\", position=position_dodge(width=.9), \n               aes(group = interaction(count_meas,month,audio_video)))+\n  facet_wrap(meas_type~audio_video, scales = \"free_y\", ncol=2)\n\nsummary(sixseven_basiclevel_home_data_agg$numtypes)\nsummary(sixseven_basiclevel_home_data_agg$numtokens)\n\n\n\n# sixseven_basiclevel_home_data %>% \n#   group_by(subj, month,SubjectNumber, audio_video) %>% \n#   arrange(subj, month, audio_video, onset) %>%\n#   mutate(winformattr = )\n#   summarise(numtokens = n(),\n#             numtypes = n_distinct(basic_level))\n```\n#MATTR\n#tables\n#figures of freq by month/word\n#by hour\n\n\n\n\n\n",
    "created" : 1501257592752.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "157884976",
    "id" : "71F776C3",
    "lastKnownWriteTime" : 1501260266,
    "last_content_update" : 1501260266720,
    "path" : "~/Desktop/backed_up_byduke/studies/sixseven/sixseven.Rmd",
    "project_path" : "sixseven.Rmd",
    "properties" : {
        "docOutlineVisible" : "1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}